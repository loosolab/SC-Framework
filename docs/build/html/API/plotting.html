<!DOCTYPE html>
<html class="writer-html5" lang="en" data-content_root="../">
<head>
  <meta charset="utf-8" /><meta name="viewport" content="width=device-width, initial-scale=1" />

  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Plotting &mdash; SC FRAMEWORK  documentation</title>
      <link rel="stylesheet" type="text/css" href="../_static/pygments.css?v=80d5e7a1" />
      <link rel="stylesheet" type="text/css" href="../_static/css/theme.css?v=19f00094" />
      <link rel="stylesheet" type="text/css" href="../_static/plot_directive.css" />

  
  <!--[if lt IE 9]>
    <script src="../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script src="../_static/jquery.js?v=5d32c60e"></script>
        <script src="../_static/_sphinx_javascript_frameworks_compat.js?v=2cd50e6c"></script>
        <script src="../_static/documentation_options.js?v=5929fcd5"></script>
        <script src="../_static/doctools.js?v=9a2dae69"></script>
        <script src="../_static/sphinx_highlight.js?v=dc90522c"></script>
        <script crossorigin="anonymous" integrity="sha256-Ae2Vz/4ePdIu6ZyI/5ZGsYnb+m0JlOmKPjt6XZ9JJkA=" src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.4/require.min.js"></script>
    <script src="../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Utils" href="utils.html" />
    <link rel="prev" title="Tools" href="tools.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../index.html" class="icon icon-home">
            SC FRAMEWORK
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../CHANGES.html">Changelog</a></li>
<li class="toctree-l1"><a class="reference internal" href="../rna-notebooks/index.html">RNA notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../atac-notebooks/index.html">ATAC notebooks</a></li>
<li class="toctree-l1"><a class="reference internal" href="../general-notebooks/index.html">General notebooks</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">sctoolbox API reference</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="tools.html">Tools</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Plotting</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#module-sctoolbox.plotting.qc_filter">qc_filter</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.qc_filter.plot_starsolo_quality"><code class="docutils literal notranslate"><span class="pre">plot_starsolo_quality()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.qc_filter.plot_starsolo_UMI"><code class="docutils literal notranslate"><span class="pre">plot_starsolo_UMI()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.qc_filter.n_cells_barplot"><code class="docutils literal notranslate"><span class="pre">n_cells_barplot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.qc_filter.group_correlation"><code class="docutils literal notranslate"><span class="pre">group_correlation()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.qc_filter.plot_insertsize"><code class="docutils literal notranslate"><span class="pre">plot_insertsize()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.qc_filter.quality_violin"><code class="docutils literal notranslate"><span class="pre">quality_violin()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.qc_filter.get_slider_thresholds"><code class="docutils literal notranslate"><span class="pre">get_slider_thresholds()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sctoolbox.plotting.highly_variable">highly_variable</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.highly_variable.violin_HVF_distribution"><code class="docutils literal notranslate"><span class="pre">violin_HVF_distribution()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.highly_variable.scatter_HVF_distribution"><code class="docutils literal notranslate"><span class="pre">scatter_HVF_distribution()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sctoolbox.plotting.embedding">embedding</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.embedding.sc_colormap"><code class="docutils literal notranslate"><span class="pre">sc_colormap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.embedding.grey_colormap"><code class="docutils literal notranslate"><span class="pre">grey_colormap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.embedding.flip_embedding"><code class="docutils literal notranslate"><span class="pre">flip_embedding()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.embedding.plot_embedding"><code class="docutils literal notranslate"><span class="pre">plot_embedding()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.embedding.search_umap_parameters"><code class="docutils literal notranslate"><span class="pre">search_umap_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.embedding.search_tsne_parameters"><code class="docutils literal notranslate"><span class="pre">search_tsne_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.embedding.plot_group_embeddings"><code class="docutils literal notranslate"><span class="pre">plot_group_embeddings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.embedding.compare_embeddings"><code class="docutils literal notranslate"><span class="pre">compare_embeddings()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.embedding.plot_3D_UMAP"><code class="docutils literal notranslate"><span class="pre">plot_3D_UMAP()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.embedding.umap_marker_overview"><code class="docutils literal notranslate"><span class="pre">umap_marker_overview()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.embedding.anndata_overview"><code class="docutils literal notranslate"><span class="pre">anndata_overview()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.embedding.plot_pca_variance"><code class="docutils literal notranslate"><span class="pre">plot_pca_variance()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.embedding.plot_pca_correlation"><code class="docutils literal notranslate"><span class="pre">plot_pca_correlation()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sctoolbox.plotting.clustering">clustering</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.clustering.search_clustering_parameters"><code class="docutils literal notranslate"><span class="pre">search_clustering_parameters()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.clustering.marker_gene_clustering"><code class="docutils literal notranslate"><span class="pre">marker_gene_clustering()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sctoolbox.plotting.marker_genes">marker_genes</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.marker_genes.rank_genes_plot"><code class="docutils literal notranslate"><span class="pre">rank_genes_plot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.marker_genes.grouped_violin"><code class="docutils literal notranslate"><span class="pre">grouped_violin()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.marker_genes.group_expression_boxplot"><code class="docutils literal notranslate"><span class="pre">group_expression_boxplot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.marker_genes.gene_expression_heatmap"><code class="docutils literal notranslate"><span class="pre">gene_expression_heatmap()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.marker_genes.plot_differential_genes"><code class="docutils literal notranslate"><span class="pre">plot_differential_genes()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.marker_genes.plot_gene_correlation"><code class="docutils literal notranslate"><span class="pre">plot_gene_correlation()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sctoolbox.plotting.genometracks">genometracks</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.genometracks.GenomeTracks"><code class="docutils literal notranslate"><span class="pre">GenomeTracks</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sctoolbox.plotting.velocity">velocity</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.velocity.pseudotime_heatmap"><code class="docutils literal notranslate"><span class="pre">pseudotime_heatmap()</span></code></a></li>
</ul>
</li>
<li class="toctree-l3"><a class="reference internal" href="#module-sctoolbox.plotting.general">general</a><ul>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.general.clustermap_dotplot"><code class="docutils literal notranslate"><span class="pre">clustermap_dotplot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.general.bidirectional_barplot"><code class="docutils literal notranslate"><span class="pre">bidirectional_barplot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.general.boxplot"><code class="docutils literal notranslate"><span class="pre">boxplot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.general.violinplot"><code class="docutils literal notranslate"><span class="pre">violinplot()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.general.plot_venn"><code class="docutils literal notranslate"><span class="pre">plot_venn()</span></code></a></li>
<li class="toctree-l4"><a class="reference internal" href="#sctoolbox.plotting.general.pairwise_scatter"><code class="docutils literal notranslate"><span class="pre">pairwise_scatter()</span></code></a></li>
</ul>
</li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="utils.html">Utils</a></li>
</ul>
</li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../index.html">SC FRAMEWORK</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="index.html">sctoolbox API reference</a></li>
      <li class="breadcrumb-item active">Plotting</li>
      <li class="wy-breadcrumbs-aside">
            <a href="../_sources/API/plotting.rst.txt" rel="nofollow"> View page source</a>
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <section id="plotting">
<h1>Plotting<a class="headerlink" href="#plotting" title="Link to this heading"></a></h1>
<p class="rubric">Loading example data</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="c1"># Import the plotting module</span>
<span class="kn">import</span> <span class="nn">sctoolbox.plotting</span> <span class="k">as</span> <span class="nn">pl</span>

<span class="c1"># Load example dataset</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">seed</span><span class="p">(</span><span class="mi">42</span><span class="p">)</span>
<span class="kn">import</span> <span class="nn">scanpy</span> <span class="k">as</span> <span class="nn">sc</span>

<span class="n">adata</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">pbmc68k_reduced</span><span class="p">()</span>
<span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;condition&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s2">&quot;C1&quot;</span><span class="p">,</span> <span class="s2">&quot;C2&quot;</span><span class="p">,</span> <span class="s2">&quot;C3&quot;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="n">adata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
</pre></div>
</div>
<hr class="docutils" />
<section id="module-sctoolbox.plotting.qc_filter">
<span id="qc-filter"></span><h2>qc_filter<a class="headerlink" href="#module-sctoolbox.plotting.qc_filter" title="Link to this heading"></a></h2>
<p>Functions for plotting QC-related figures e.g. number of cells per group and violins.</p>
<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.qc_filter.plot_starsolo_quality">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.qc_filter.</span></span><span class="sig-name descname"><span class="pre">plot_starsolo_quality</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measures</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['Number</span> <span class="pre">of</span> <span class="pre">Reads',</span> <span class="pre">'Reads</span> <span class="pre">Mapped</span> <span class="pre">to</span> <span class="pre">Genome:</span> <span class="pre">Unique',</span> <span class="pre">'Reads</span> <span class="pre">Mapped</span> <span class="pre">to</span> <span class="pre">Gene:</span> <span class="pre">Unique</span> <span class="pre">Gene',</span> <span class="pre">'Fraction</span> <span class="pre">of</span> <span class="pre">Unique</span> <span class="pre">Reads</span> <span class="pre">in</span> <span class="pre">Cells',</span> <span class="pre">'Median</span> <span class="pre">Reads</span> <span class="pre">per</span> <span class="pre">Cell',</span> <span class="pre">'Median</span> <span class="pre">Gene</span> <span class="pre">per</span> <span class="pre">Cell']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">order</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/qc_filter.html#plot_starsolo_quality"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.qc_filter.plot_starsolo_quality" title="Link to this definition"></a></dt>
<dd><p>Plot quality measures from starsolo as barplots per condition.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder</strong> (<em>str</em>) – Path to a folder, e.g. “path/to/starsolo_output”, which contains folders “solorun1”, “solorun2”, etc.</p></li>
<li><p><strong>measures</strong> (<em>list</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default</em><em> [</em><em>&quot;Number</em><em> of </em><em>Reads&quot;</em><em>, </em><em>&quot;Reads Mapped to Genome: Unique&quot;</em><em>, </em><em>&quot;Reads Mapped to Gene: Unique Gene&quot;</em><em>, </em><em>&quot;Fraction</em><em> of </em><em>Unique Reads in Cells&quot;</em><em>, </em><em>&quot;Median Reads per Cell&quot;</em><em>, </em><em>&quot;Median Gene per Cell&quot;</em><em>]</em>) – List of measures to plot. Must be available in the solo summary table.</p></li>
<li><p><strong>ncol</strong> (<em>int</em><em>, </em><em>default 3</em>) – Number of columns in the plot.</p></li>
<li><p><strong>order</strong> (<em>Optional</em><em>[</em><em>list</em><em>[</em><em>str</em><em>]</em><em>]</em><em>, </em><em>default None</em>) – Order of conditions in the plot. If None, the order is alphabetical.</p></li>
<li><p><strong>save</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Path to save the plot. If None, the plot is not saved.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional arguments passed to seaborn.barplot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>axes</strong> – Array of axes objects containing the plot(s).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>KeyError</strong> – If a measure is not available in the solo summary table.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">plot_starsolo_quality</span><span class="p">(</span><span class="s2">&quot;data/quant/&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-2.png" class="plot-directive" src="../_images/plotting-2.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.qc_filter.plot_starsolo_UMI">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.qc_filter.</span></span><span class="sig-name descname"><span class="pre">plot_starsolo_UMI</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">folder</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncol</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/qc_filter.html#plot_starsolo_UMI"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.qc_filter.plot_starsolo_UMI" title="Link to this definition"></a></dt>
<dd><p>Plot UMI distribution for each condition in a folder.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>folder</strong> (<em>str</em>) – Path to a folder, e.g. “path/to/starsolo_output”, which contains folders “solorun1”, “solorun2”, etc.</p></li>
<li><p><strong>ncol</strong> (<em>int</em><em>, </em><em>default 3</em>) – Number of columns in the plot.</p></li>
<li><p><strong>save</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Path to save the plot. If None, the plot is not saved.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>axes</strong> – Array of axes objects containing the plot(s).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If no UMI files (‘UMIperCellSorted.txt’) are found in the folder.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">plot_starsolo_UMI</span><span class="p">(</span><span class="s2">&quot;data/quant/&quot;</span><span class="p">,</span> <span class="n">ncol</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-3.png" class="plot-directive" src="../_images/plotting-3.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.qc_filter.n_cells_barplot">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.qc_filter.</span></span><span class="sig-name descname"><span class="pre">n_cells_barplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">stacked</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">add_labels</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Axes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/qc_filter.html#n_cells_barplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.qc_filter.n_cells_barplot" title="Link to this definition"></a></dt>
<dd><p>Plot number and percentage of cells per group in a barplot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>sc.AnnData</em>) – Annotated data matrix object.</p></li>
<li><p><strong>x</strong> (<em>str</em>) – Name of the column in adata.obs to group by on the x axis.</p></li>
<li><p><strong>groupby</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Name of the column in adata.obs to created stacked bars on the y axis. If None, the bars are not split.</p></li>
<li><p><strong>stacked</strong> (<em>bool</em><em>, </em><em>default True</em>) – Whether to stack the bars or not.</p></li>
<li><p><strong>save</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Path to save the plot. If None, the plot is not saved.</p></li>
<li><p><strong>figsize</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em> | </em><em>float</em><em>, </em><em>int</em><em> | </em><em>float</em><em>]</em><em>]</em><em>, </em><em>default None</em>) – Size of figure, e.g. (4, 8). If None, size is determined automatically depending on whether groupby is None or not.</p></li>
<li><p><strong>add_labels</strong> (<em>bool</em><em>, </em><em>default False</em>) – Whether to add labels to the bars giving the number/percentage of cells.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional arguments passed to pandas.DataFrame.plot.bar.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>axarr</strong> – Array of axes objects containing the plot(s).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Iterable[matplotlib.axes.Axes]</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">n_cells_barplot</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;louvain&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-4.png" class="plot-directive" src="../_images/plotting-4.png" />
</figure>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">n_cells_barplot</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">x</span><span class="o">=</span><span class="s2">&quot;louvain&quot;</span><span class="p">,</span> <span class="n">groupby</span><span class="o">=</span><span class="s2">&quot;condition&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-5.png" class="plot-directive" src="../_images/plotting-5.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.qc_filter.group_correlation">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.qc_filter.</span></span><span class="sig-name descname"><span class="pre">group_correlation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'spearman'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'pearson'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'kendall'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Callable</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'spearman'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ClusterGrid</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/qc_filter.html#group_correlation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.qc_filter.group_correlation" title="Link to this definition"></a></dt>
<dd><p>Plot correlation matrix between groups in <cite>groupby</cite>.</p>
<p>The function expects the count data in .X to be normalized across cells.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>sc.AnnData</em>) – Annotated data matrix object.</p></li>
<li><p><strong>groupby</strong> (<em>str</em>) – Name of the column in adata.obs to group cells by.</p></li>
<li><p><strong>method</strong> (<em>Literal</em><em>[</em><em>&quot;spearman&quot;</em><em>, </em><em>&quot;pearson&quot;</em><em>, </em><em>&quot;kendall&quot;</em><em>] </em><em>| </em><em>Callable</em><em>, </em><em>default &quot;spearman&quot;</em>) – Correlation method to use. See pandas.DataFrame.corr for options.</p></li>
<li><p><strong>save</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Path to save the plot. If None, the plot is not saved.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional arguments passed to seaborn.clustermap.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>sns.matrix.ClusterGrid</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scanpy</span> <span class="k">as</span> <span class="nn">sc</span>
<span class="kn">import</span> <span class="nn">sctoolbox.plotting</span> <span class="k">as</span> <span class="nn">pl</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">adata</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">pbmc68k_reduced</span><span class="p">()</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">group_correlation</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="s2">&quot;phase&quot;</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;spearman&quot;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-8.png" class="plot-directive" src="../_images/plotting-8.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.qc_filter.plot_insertsize">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.qc_filter.</span></span><span class="sig-name descname"><span class="pre">plot_insertsize</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">barcodes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Axes</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/qc_filter.html#plot_insertsize"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.qc_filter.plot_insertsize" title="Link to this definition"></a></dt>
<dd><p>Plot insertsize distribution for barcodes in adata. Requires adata.uns[“insertsize_distribution”] to be set.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>sc.AnnData</em>) – AnnData object containing insertsize distribution in adata.uns[“insertsize_distribution”].</p></li>
<li><p><strong>barcodes</strong> (<em>Optional</em><em>[</em><em>list</em><em>[</em><em>str</em><em>]</em><em>]</em><em>, </em><em>default None</em>) – Subset of barcodes to plot information for. If None, all barcodes are used.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional arguments passed to seaborn.lineplot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong> – Axes object containing the plot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.axes.Axes</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If adata.uns[“insertsize_distribution”] is not set.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.qc_filter.quality_violin">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.qc_filter.</span></span><span class="sig-name descname"><span class="pre">quality_violin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">which</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'obs'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'var'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'obs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">header</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'min'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'max'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'min'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'max'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">global_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">interactive</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/qc_filter.html#quality_violin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.qc_filter.quality_violin" title="Link to this definition"></a></dt>
<dd><p>Plot quality measurements for cells/features in an anndata object.</p>
<p class="rubric">Notes</p>
<p>Notebook needs “%matplotlib widget” before the call for the interactive sliders to work.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>sc.AnnData</em>) – Anndata object containing quality measures in .obs/.var</p></li>
<li><p><strong>columns</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – A list of columns in .obs/.var to show measures for.</p></li>
<li><p><strong>which</strong> (<em>Literal</em><em>[</em><em>&quot;obs&quot;</em><em>, </em><em>&quot;var&quot;</em><em>]</em><em>, </em><em>default &quot;obs&quot;</em>) – Which table to show quality for. Either “obs” / “var”.</p></li>
<li><p><strong>groupby</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default &quot;condition&quot;</em>) – A column in table to values on the x-axis.</p></li>
<li><p><strong>ncols</strong> (<em>int</em><em>, </em><em>default 2</em>) – Number of columns in the plot.</p></li>
<li><p><strong>header</strong> (<em>Optional</em><em>[</em><em>list</em><em>[</em><em>str</em><em>]</em><em>]</em><em>, </em><em>defaul None</em>) – A list of custom headers for each measure given in columns.</p></li>
<li><p><strong>color_list</strong> (<em>Optional</em><em>[</em><em>list</em><em>[</em><em>str</em><em>]</em><em>]</em><em>, </em><em>default None</em>) – A list of colors to use for violins. If None, colors are chosen automatically.</p></li>
<li><p><strong>title</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – The title of the full plot.</p></li>
<li><p><strong>thresholds</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>dict</em><em>[</em><em>str</em><em>, </em><em>dict</em><em>[</em><em>Literal</em><em>[</em><em>&quot;min&quot;</em><em>, </em><em>&quot;max&quot;</em><em>]</em><em>, </em><em>int</em><em> | </em><em>float</em><em>]</em><em>] </em><em>| </em><em>dict</em><em>[</em><em>Literal</em><em>[</em><em>&quot;min&quot;</em><em>, </em><em>&quot;max&quot;</em><em>]</em><em>, </em><em>int</em><em> | </em><em>float</em><em>]</em><em>]</em><em>]</em><em>, </em><em>default None</em>) – Dictionary containing initial min/max thresholds to show in plot.</p></li>
<li><p><strong>global_threshold</strong> (<em>bool</em><em>, </em><em>default True</em>) – Whether to use global thresholding as the initial setting. If False, thresholds are set per group.</p></li>
<li><p><strong>interactive</strong> (<em>bool</em><em>, </em><em>default True</em>) – Whether to show interactive sliders. If False, the static matplotlib plot is shown.</p></li>
<li><p><strong>save</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>optional</em>) – Save the figure to the path given in ‘save’. Default: None (figure is not saved).</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional arguments passed to seaborn.violinplot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Tuple[Union[matplotlib.figure.Figure, ipywidgets.HBox], Dict[str, Union[List[ipywidgets.FloatRangeSlider.observe], Dict[str, ipywidgets.FloatRangeSlider.observe]]]]
First element contains figure (static) or figure and sliders (interactive). The second element is a nested dict of slider values that are continously updated.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Tuple[Any, Dict[str, Any]]</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If ‘which’ is not ‘obs’ or ‘var’ or if columns are not in table.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.qc_filter.get_slider_thresholds">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.qc_filter.</span></span><span class="sig-name descname"><span class="pre">get_slider_thresholds</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">slider_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/qc_filter.html#get_slider_thresholds"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.qc_filter.get_slider_thresholds" title="Link to this definition"></a></dt>
<dd><p>Get thresholds from sliders.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>slider_dict</strong> (<em>dict</em>) – Dictionary of sliders in the format ‘slider_dict[column][group] = slider’ or ‘slider_dict[column] = slider’ if no grouping.</p>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>dict in the format threshold_dict[column][group] = {“min”: &lt;min_threshold&gt;, “max”: &lt;max_threshold&gt;} or
threshold_dict[column] = {“min”: &lt;min_threshold&gt;, “max”: &lt;max_threshold&gt;} if no grouping</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>dict</p>
</dd>
</dl>
</dd></dl>

</section>
<hr class="docutils" />
<section id="module-sctoolbox.plotting.highly_variable">
<span id="highly-variable"></span><h2>highly_variable<a class="headerlink" href="#module-sctoolbox.plotting.highly_variable" title="Link to this heading"></a></h2>
<p>Plots for highly variable genes, e.g. as a result of sc.tl.highly_variable.</p>
<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.highly_variable.violin_HVF_distribution">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.highly_variable.</span></span><span class="sig-name descname"><span class="pre">violin_HVF_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sctoolbox/plotting/highly_variable.html#violin_HVF_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.highly_variable.violin_HVF_distribution" title="Link to this definition"></a></dt>
<dd><p>Plot the distribution of the HVF as violinplot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>sc.AnnData</em>) – AnnData object containing columns [‘highly_variable’, ‘n_cells_by_counts’] column.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Keyword arguments to be passed to matplotlib.pyplot.violinplot.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.highly_variable.scatter_HVF_distribution">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.highly_variable.</span></span><span class="sig-name descname"><span class="pre">scatter_HVF_distribution</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sctoolbox/plotting/highly_variable.html#scatter_HVF_distribution"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.highly_variable.scatter_HVF_distribution" title="Link to this definition"></a></dt>
<dd><p>Plot the distribution of the HVF as scatterplot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>sc.AnnData</em>) – AnnData object containing columns [‘variability_score’, ‘n_cells’] column.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Keyword arguments to be passed to matplotlib.pyplot.scatter.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

</section>
<section id="module-sctoolbox.plotting.embedding">
<span id="embedding"></span><h2>embedding<a class="headerlink" href="#module-sctoolbox.plotting.embedding" title="Link to this heading"></a></h2>
<p>Funtions of different single cell embeddings e.g. UMAP, PCA, tSNE.</p>
<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.embedding.sc_colormap">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.embedding.</span></span><span class="sig-name descname"><span class="pre">sc_colormap</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ListedColormap</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/embedding.html#sc_colormap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.embedding.sc_colormap" title="Link to this definition"></a></dt>
<dd><p>Get a colormap with 0-count cells colored grey (to use for embeddings).</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cmap</strong> – Colormap with 0-count cells colored grey.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>matplotlib.colors.ListedColormap</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.embedding.grey_colormap">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.embedding.</span></span><span class="sig-name descname"><span class="pre">grey_colormap</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ListedColormap</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/embedding.html#grey_colormap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.embedding.grey_colormap" title="Link to this definition"></a></dt>
<dd><p>Get a colormap with grey-scale colors, but without white to still show cells.</p>
<dl class="field-list simple">
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>cmap</strong> – Grey-scale colormap.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>matplotlib.colors.ListedColormap</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.embedding.flip_embedding">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.embedding.</span></span><span class="sig-name descname"><span class="pre">flip_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'X_umap'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">how</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'vertical'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'horizontal'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'vertical'</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sctoolbox/plotting/embedding.html#flip_embedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.embedding.flip_embedding" title="Link to this definition"></a></dt>
<dd><p>Flip the embedding in adata.obsm[key] along the given axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>sc.AnnData</em>) – Annotated data matrix object.</p></li>
<li><p><strong>key</strong> (<em>str</em><em>, </em><em>default &quot;X_umap&quot;</em>) – Key in adata.obsm to flip.</p></li>
<li><p><strong>how</strong> (<em>Literal</em><em>[</em><em>&quot;vertical&quot;</em><em>, </em><em>&quot;horizontal&quot;</em><em>]</em><em>, </em><em>default &quot;vertical&quot;</em>) – Axis to flip along. Can be “vertical” (flips up/down) or “horizontal” (flips left/right).</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>KeyError</strong> – If the given key is not found in adata.obsm.</p></li>
<li><p><strong>ValueError</strong> – If the given ‘how’ is not supported.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.embedding.plot_embedding">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.embedding.</span></span><span class="sig-name descname"><span class="pre">plot_embedding</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'umap'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">style</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'dots'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'hexbin'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'density'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'dots'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_borders</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_contour</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_count</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hexbin_gridsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">30</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shrink_colorbar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">square</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/embedding.html#plot_embedding"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.embedding.plot_embedding" title="Link to this definition"></a></dt>
<dd><p>Plot a dimensionality reduction embedding e.g. UMAP or tSNE with different style options. This is a wrapper around scanpy.pl.embedding.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>anndata.AnnData</em>) – Annotated data matrix object.</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>default &quot;umap&quot;</em>) – Dimensionality reduction method to use. Must be a key in adata.obsm, or a method available as “X_&lt;method&gt;” such as “umap”, “tsne” or “pca”.</p></li>
<li><p><strong>color</strong> (<em>Optional</em><em>[</em><em>str</em><em> | </em><em>list</em><em>[</em><em>str</em><em>]</em><em>]</em><em>, </em><em>default None</em>) – Key for annotation of observations/cells or variables/genes.</p></li>
<li><p><strong>style</strong> (<em>Literal</em><em>[</em><em>&quot;dots&quot;</em><em>, </em><em>&quot;hexbin&quot;</em><em>, </em><em>&quot;density&quot;.</em><em>]</em><em>, </em><em>default &quot;dots&quot;</em>) – Style of the plot. Must be one of “dots”, “hexbin” or “density”.</p></li>
<li><p><strong>show_borders</strong> (<em>bool</em><em>, </em><em>default False</em>) – Whether to show borders around embedding plot. If False, the borders are removed and a small legend is added to the plot.</p></li>
<li><p><strong>show_contour</strong> (<em>bool</em><em>, </em><em>default False</em>) – Whether to show a contour plot on top of the plot.</p></li>
<li><p><strong>show_count</strong> (<em>bool</em><em>, </em><em>default True</em>) – Whether to show the number of cells in the plot.</p></li>
<li><p><strong>show_title</strong> (<em>bool</em><em>, </em><em>default True</em>) – Whether to show the titles of the plots. If False, the titles are removed and the names are added to the colorbar/legend instead.</p></li>
<li><p><strong>hexbin_gridsize</strong> (<em>int</em><em>, </em><em>default 30</em>) – Number of hexbins across plot - higher values give smaller bins. Only used if style=”hexbin”.</p></li>
<li><p><strong>shrink_colorbar</strong> (<em>float</em><em> | </em><em>int</em><em>, </em><em>default 0.3</em>) – Shrink the height of the colorbar by this factor.</p></li>
<li><p><strong>square</strong> (<em>bool</em><em>, </em><em>default True</em>) – Whether to make the plot square.</p></li>
<li><p><strong>save</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Filename to save the figure.</p></li>
<li><p><strong>**kwargs</strong> (<em>arguments</em>) – Additional keyword arguments are passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">scanpy.pl.plot_embedding()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>axes</strong> – Array of axis objects</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.ArrayLike</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>KeyError</strong> – If the given method is not found in adata.obsm.</p></li>
<li><p><strong>ValueError</strong> – If the ‘components’ given is larger than the number of components in the embedding.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">plot_embedding</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;louvain&quot;</span><span class="p">,</span> <span class="n">legend_loc</span><span class="o">=</span><span class="s2">&quot;on data&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-9.png" class="plot-directive" src="../_images/plotting-9.png" />
</figure>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">plot_embedding</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;pca&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;n_genes&quot;</span><span class="p">,</span> <span class="n">show_contour</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">show_title</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-10.png" class="plot-directive" src="../_images/plotting-10.png" />
</figure>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">plot_embedding</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;n_genes&#39;</span><span class="p">,</span> <span class="s1">&#39;HES4&#39;</span><span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;hexbin&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-11.png" class="plot-directive" src="../_images/plotting-11.png" />
</figure>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">_</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">plot_embedding</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;pca&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;n_genes&#39;</span><span class="p">,</span> <span class="s1">&#39;HES4&#39;</span><span class="p">],</span>
                      <span class="n">style</span><span class="o">=</span><span class="s2">&quot;hexbin&quot;</span><span class="p">,</span> <span class="n">components</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;1,2&quot;</span><span class="p">,</span> <span class="s2">&quot;2,3&quot;</span><span class="p">],</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-12.png" class="plot-directive" src="../_images/plotting-12.png" />
</figure>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">ax</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">plot_embedding</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;n_genes&#39;</span><span class="p">,</span> <span class="s1">&#39;louvain&#39;</span><span class="p">],</span> <span class="n">style</span><span class="o">=</span><span class="s2">&quot;density&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-13.png" class="plot-directive" src="../_images/plotting-13.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.embedding.search_umap_parameters">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.embedding.</span></span><span class="sig-name descname"><span class="pre">search_umap_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">min_dist_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0.2,</span> <span class="pre">0.9,</span> <span class="pre">0.2)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">spread_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0.5,</span> <span class="pre">2.0,</span> <span class="pre">0.5)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/embedding.html#search_umap_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.embedding.search_umap_parameters" title="Link to this definition"></a></dt>
<dd><p>Plot a grid of different combinations of min_dist and spread variables for UMAP plots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>sc.AnnData</em>) – Annotated data matrix object.</p></li>
<li><p><strong>min_dist_range</strong> (<em>Tuple</em><em>[</em><em>float</em><em> | </em><em>int</em><em>, </em><em>float</em><em> | </em><em>int</em><em>, </em><em>float</em><em> | </em><em>int</em><em>]</em><em>, </em><em>default:</em><em> (</em><em>0.2</em><em>, </em><em>0.9</em><em>, </em><em>0.2</em><em>)</em>) – Range of ‘min_dist’ parameter values to test. Must be a tuple in the form (min, max, step).</p></li>
<li><p><strong>spread_range</strong> (<em>Tuple</em><em>[</em><em>float</em><em> | </em><em>int</em><em>, </em><em>float</em><em> | </em><em>int</em><em>, </em><em>float</em><em> | </em><em>int</em><em>]</em><em>, </em><em>default</em><em> (</em><em>0.5</em><em>, </em><em>2.0</em><em>, </em><em>0.5</em><em>)</em>) – Range of ‘spread’ parameter values to test. Must be a tuple in the form (min, max, step).</p></li>
<li><p><strong>color</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Name of the column in adata.obs to color plots by. If None, plots are not colored.</p></li>
<li><p><strong>n_components</strong> (<em>int</em><em>, </em><em>default 2</em>) – Number of components in UMAP calculation.</p></li>
<li><p><strong>threads</strong> (<em>int</em><em>, </em><em>default 4</em>) – Number of threads to use for UMAP calculation.</p></li>
<li><p><strong>save</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Path to save the figure to. If None, the figure is not saved.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional keyword arguments are passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">scanpy.tl.umap()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D numpy array of axis objects</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">search_umap_parameters</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">min_dist_range</span><span class="o">=</span><span class="p">(</span><span class="mf">0.2</span><span class="p">,</span> <span class="mf">0.9</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span>
                                 <span class="n">spread_range</span><span class="o">=</span><span class="p">(</span><span class="mf">2.0</span><span class="p">,</span> <span class="mf">3.0</span><span class="p">,</span> <span class="mf">0.5</span><span class="p">),</span>
                                 <span class="n">color</span><span class="o">=</span><span class="s2">&quot;bulk_labels&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-14.png" class="plot-directive" src="../_images/plotting-14.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.embedding.search_tsne_parameters">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.embedding.</span></span><span class="sig-name descname"><span class="pre">search_tsne_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">perplexity_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(30,</span> <span class="pre">60,</span> <span class="pre">10)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">learning_rate_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(600,</span> <span class="pre">1000,</span> <span class="pre">200)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">threads</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/embedding.html#search_tsne_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.embedding.search_tsne_parameters" title="Link to this definition"></a></dt>
<dd><p>Plot a grid of different combinations of perplexity and learning_rate variables for tSNE plots.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>sc.AnnData</em>) – Annotated data matrix object.</p></li>
<li><p><strong>perplexity_range</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>, </em><em>int</em><em>]</em><em>, </em><em>default</em><em> (</em><em>30</em><em>, </em><em>60</em><em>, </em><em>10</em><em>)</em>) – tSNE parameter: Range of ‘perplexity’ parameter values to test. Must be a tuple in the form (min, max, step).</p></li>
<li><p><strong>learning_rate_range</strong> (<em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>, </em><em>int</em><em>]</em><em>, </em><em>default</em><em> (</em><em>600</em><em>, </em><em>1000</em><em>, </em><em>200</em><em>)</em>) – tSNE parameter: Range of ‘learning_rate’ parameter values to test. Must be a tuple in the form (min, max, step).</p></li>
<li><p><strong>color</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Name of the column in adata.obs to color plots by. If None, plots are not colored.</p></li>
<li><p><strong>threads</strong> (<em>int</em><em>, </em><em>default 1</em>) – The threads paramerter is currently not supported. Please leave at 1.
This may be fixed in the future.</p></li>
<li><p><strong>save</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em><em> (</em><em>not saved</em><em>)</em>) – Path to save the figure to.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional keyword arguments are passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">scanpy.tl.tsne()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D numpy array of axis objects</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">search_tsne_parameters</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">perplexity_range</span><span class="o">=</span><span class="p">(</span><span class="mi">30</span><span class="p">,</span> <span class="mi">60</span><span class="p">,</span> <span class="mi">10</span><span class="p">),</span>
                                 <span class="n">learning_rate_range</span><span class="o">=</span><span class="p">(</span><span class="mi">600</span><span class="p">,</span> <span class="mi">1000</span><span class="p">,</span> <span class="mi">200</span><span class="p">),</span>
                                 <span class="n">color</span><span class="o">=</span><span class="s2">&quot;bulk_labels&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-15.png" class="plot-directive" src="../_images/plotting-15.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.embedding.plot_group_embeddings">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.embedding.</span></span><span class="sig-name descname"><span class="pre">plot_group_embeddings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'umap'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'tsne'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'pca'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'umap'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">4</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/embedding.html#plot_group_embeddings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.embedding.plot_group_embeddings" title="Link to this definition"></a></dt>
<dd><p>Plot a grid of embeddings (UMAP/tSNE/PCA) per group of cells within ‘groupby’.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>sc.AnnData</em>) – Annotated data matrix object.</p></li>
<li><p><strong>groupby</strong> (<em>str</em>) – Name of the column in adata.obs to group by.</p></li>
<li><p><strong>embedding</strong> (<em>Literal</em><em>[</em><em>&quot;umap&quot;</em><em>, </em><em>&quot;tsne&quot;</em><em>, </em><em>&quot;pca&quot;</em><em>]</em><em>, </em><em>default &quot;umap&quot;</em>) – Embedding to plot. Must be one of “umap”, “tsne”, “pca”.</p></li>
<li><p><strong>ncols</strong> (<em>int</em><em>, </em><em>default 4</em>) – Number of columns in the figure.</p></li>
<li><p><strong>save</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Path to save the figure.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional keyword arguments are passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">scanpy.pl.umap()</span></code> or <code class="xref py py-func docutils literal notranslate"><span class="pre">scanpy.pl.tsne()</span></code> or <code class="xref py py-func docutils literal notranslate"><span class="pre">scanpy.pl.pca()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Flat numpy array of axis objects</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">plot_group_embeddings</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="n">embedding</span><span class="o">=</span><span class="s1">&#39;umap&#39;</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">4</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-16.png" class="plot-directive" src="../_images/plotting-16.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.embedding.compare_embeddings">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.embedding.</span></span><span class="sig-name descname"><span class="pre">compare_embeddings</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">AnnData</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">var_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'umap'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'tsne'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'pca'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'umap'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">adata_names</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/embedding.html#compare_embeddings"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.embedding.compare_embeddings" title="Link to this definition"></a></dt>
<dd><p>Compare embeddings across different adata objects.</p>
<p>Plots a grid of embeddings with the different adatas on the x-axis, and colored variables on the y-axis.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata_list</strong> (<em>list</em><em>[</em><em>sc.AnnData</em><em>]</em>) – List of AnnData objects to compare.</p></li>
<li><p><strong>var_list</strong> (<em>list</em><em>[</em><em>str</em><em>] </em><em>| </em><em>str</em>) – List of variables to color in plot.</p></li>
<li><p><strong>embedding</strong> (<em>Literal</em><em>[</em><em>&quot;umap&quot;</em><em>, </em><em>&quot;tsne&quot;</em><em>, </em><em>&quot;pca&quot;</em><em>]</em><em>, </em><em>default &quot;umap&quot;</em>) – Embedding to plot. Must be one of “umap”, “tsne” or “pca”.</p></li>
<li><p><strong>adata_names</strong> (<em>Optional</em><em>[</em><em>list</em><em>[</em><em>str</em><em>]</em><em>]</em><em>, </em><em>default None</em><em> (</em><em>adatas will be named adata_1</em><em>, </em><em>adata_2</em><em>, </em><em>etc.</em><em>)</em>) – List of names for the adata objects. Must be the same length as adata_list or None</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional arguments to pass to sc.pl.umap/sc.pl.tsne/sc.pl.pca.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>2D numpy array of axis objects</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If none of the variables in var_list are found in any of the adata objects.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">scanpy</span> <span class="k">as</span> <span class="nn">sc</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">adata1</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">pbmc68k_reduced</span><span class="p">()</span>
<span class="n">adata2</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">datasets</span><span class="o">.</span><span class="n">pbmc3k_processed</span><span class="p">()</span>
<span class="n">adata_list</span> <span class="o">=</span> <span class="p">[</span><span class="n">adata1</span><span class="p">,</span> <span class="n">adata2</span><span class="p">]</span>
<span class="n">var_list</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;n_counts&#39;</span><span class="p">,</span> <span class="s1">&#39;n_cells&#39;</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">compare_embeddings</span><span class="p">(</span><span class="n">adata_list</span><span class="p">,</span> <span class="n">var_list</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-19.png" class="plot-directive" src="../_images/plotting-19.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.embedding.plot_3D_UMAP">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.embedding.</span></span><span class="sig-name descname"><span class="pre">plot_3D_UMAP</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/embedding.html#plot_3D_UMAP"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.embedding.plot_3D_UMAP" title="Link to this definition"></a></dt>
<dd><p>Save 3D UMAP plot to a html file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>sc.AnnData</em>) – Annotated data matrix.</p></li>
<li><p><strong>color</strong> (<em>str</em>) – Variable to color in plot. Must be a column in adata.obs or an index in adata.var.</p></li>
<li><p><strong>save</strong> (<em>str</em>) – Save prefix. Plot will be saved to &lt;save&gt;.html.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional keyword arguments are passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">plotly.graph_objects.Scatter3d()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>KeyError</strong> – If the given ‘color’ attribute was not found in adata.obs columns or adata.var index.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">min_dist</span> <span class="o">=</span> <span class="mf">0.3</span>
<span class="n">spread</span> <span class="o">=</span> <span class="mf">2.5</span>
<span class="n">sc</span><span class="o">.</span><span class="n">tl</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">min_dist</span><span class="o">=</span><span class="n">min_dist</span><span class="p">,</span> <span class="n">spread</span><span class="o">=</span><span class="n">spread</span><span class="p">,</span> <span class="n">n_components</span><span class="o">=</span><span class="mi">3</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">plot_3D_UMAP</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;louvain&quot;</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="s2">&quot;my3d_umap&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>This will create an .html-file with the interactive 3D UMAP: <a class="reference download internal" download="" href="../_downloads/ea40269db72c04b4b4ba0dc93741828a/my3d_umap.html"><code class="xref download docutils literal notranslate"><span class="pre">my3d_umap.html</span></code></a></p>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.embedding.umap_marker_overview">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.embedding.</span></span><span class="sig-name descname"><span class="pre">umap_marker_overview</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">markers</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cbar_label</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Relative</span> <span class="pre">expr.'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/embedding.html#umap_marker_overview"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.embedding.umap_marker_overview" title="Link to this definition"></a></dt>
<dd><p>Plot a pretty grid of UMAPs with marker gene expression.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>sc.AnnData</em>) – Annotated data matrix.</p></li>
<li><p><strong>markers</strong> (<em>list</em><em>[</em><em>str</em><em>] </em><em>| </em><em>str</em>) – List of markers or singel marker</p></li>
<li><p><strong>ncols</strong> (<em>int</em><em>, </em><em>default 3</em>) – Number of columns in grid.</p></li>
<li><p><strong>figsize</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>, </em><em>default None</em>) – Tuple of figure size.</p></li>
<li><p><strong>save</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – If not None save plot under given name.</p></li>
<li><p><strong>cbar_label</strong> (<em>str</em><em>, </em><em>default &quot;Relative expr.&quot;</em>) – Colorbar label</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional parameter for scanpy.pl.umap()</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of axis objects</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.embedding.anndata_overview">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.embedding.</span></span><span class="sig-name descname"><span class="pre">anndata_overview</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adatas</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">AnnData</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plots</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'UMAP'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'tSNE'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'PCA'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'PCA-var'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'LISI'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'UMAP'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'tSNE'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'PCA'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'PCA-var'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'LISI'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">['PCA',</span> <span class="pre">'PCA-var',</span> <span class="pre">'UMAP',</span> <span class="pre">'LISI']</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">max_clusters</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">_SupportsArray</span><span class="p"><span class="pre">[</span></span><span class="pre">dtype</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">_NestedSequence</span><span class="p"><span class="pre">[</span></span><span class="pre">bool</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">complex</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">bytes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/embedding.html#anndata_overview"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.embedding.anndata_overview" title="Link to this definition"></a></dt>
<dd><p>Create a multipanel plot comparing PCA/UMAP/tSNE/(…) plots for different adata objects.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adatas</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>sc.AnnData</em><em>]</em>) – Dict containing an anndata object for each batch correction method as values. Keys are the name of the respective method.
E.g.: {“bbknn”: anndata}</p></li>
<li><p><strong>color_by</strong> (<em>str</em><em> | </em><em>list</em><em>[</em><em>str</em><em>]</em>) – Name of the .obs column to use for coloring in applicable plots (e.g. for UMAP or PCA).</p></li>
<li><p><strong>plots</strong> (<em>Union</em><em>[</em><em>list</em><em>[</em><em>Literal</em><em>[</em><em>&quot;UMAP&quot;</em><em>, </em><em>&quot;tSNE&quot;</em><em>, </em><em>&quot;PCA&quot;</em><em>, </em><em>&quot;PCA-var&quot;</em><em>, </em><em>&quot;LISI&quot;</em><em>]</em><em>]</em><em>,</em>) – Literal[“UMAP”, “tSNE”, “PCA”, “PCA-var”, “LISI”]], default [“PCA”, “PCA-var”, “UMAP”, “LISI”]
Decide which plots should be created. Options are [“UMAP”, “tSNE”, “PCA”, “PCA-var”, “LISI”]
Note: List order is forwarded to plot.
- UMAP: Plots the UMAP embedding of the data.
- tSNE: Plots the tSNE embedding of the data.
- PCA: Plots the PCA embedding of the data.
- PCA-var: Plots the variance explained by each PCA component.
- LISI: Plots the distribution of any “LISI_score*” scores available in adata.obs</p></li>
<li><p><strong>figsize</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>, </em><em>default None</em>) – Size of the plot in inch. Defaults to automatic size based on number of columns/rows.</p></li>
<li><p><strong>max_clusters</strong> (<em>int</em><em>, </em><em>default 20</em>) – Maximum number of clusters to show in legend.</p></li>
<li><p><strong>output</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Path to plot output file.</p></li>
<li><p><strong>dpi</strong> (<em>int</em><em>, </em><em>default 300</em>) – Dots per inch for output</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional keyword arguments are passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">scanpy.pl.umap()</span></code>, <code class="xref py py-func docutils literal notranslate"><span class="pre">scanpy.pl.tsne()</span></code> or <code class="xref py py-func docutils literal notranslate"><span class="pre">scanpy.pl.pca()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>axes</strong> – Array of matplotlib.axes.Axes objects created by matplotlib.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>npt.ArrayLike</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If any of the adatas is not of type anndata.AnnData.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">adatas</span> <span class="o">=</span> <span class="p">{}</span>  <span class="c1"># dictionary of adata objects</span>
<span class="n">adatas</span><span class="p">[</span><span class="s2">&quot;standard&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adata</span>
<span class="n">adatas</span><span class="p">[</span><span class="s2">&quot;parameter1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">tl</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">min_dist</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
<span class="n">adatas</span><span class="p">[</span><span class="s2">&quot;parameter2&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">sc</span><span class="o">.</span><span class="n">tl</span><span class="o">.</span><span class="n">umap</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">min_dist</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">copy</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

<span class="n">pl</span><span class="o">.</span><span class="n">anndata_overview</span><span class="p">(</span><span class="n">adatas</span><span class="p">,</span> <span class="n">color_by</span><span class="o">=</span><span class="s2">&quot;louvain&quot;</span><span class="p">,</span> <span class="n">plots</span><span class="o">=</span><span class="p">[</span><span class="s2">&quot;PCA&quot;</span><span class="p">,</span> <span class="s2">&quot;PCA-var&quot;</span><span class="p">,</span> <span class="s2">&quot;UMAP&quot;</span><span class="p">])</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-22.png" class="plot-directive" src="../_images/plotting-22.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.embedding.plot_pca_variance">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.embedding.</span></span><span class="sig-name descname"><span class="pre">plot_pca_variance</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'pca'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_pcs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">20</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">selected</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_cumulative</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_thresh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corr_plot</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'spearmanr'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'pearsonr'</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corr_on</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'obs'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'var'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'obs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">corr_thresh</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Axes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sel_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'grey'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">om_col</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'lightgrey'</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Axes</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/embedding.html#plot_pca_variance"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.embedding.plot_pca_variance" title="Link to this definition"></a></dt>
<dd><p>Plot the pca variance explained by each component as a barplot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>sc.AnnData</em>) – Annotated data matrix object.</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>default &quot;pca&quot;</em>) – Method used for calculating variation. Is used to look for the coordinates in adata.uns[&lt;method&gt;].</p></li>
<li><p><strong>n_pcs</strong> (<em>int</em><em>, </em><em>default 20</em>) – Number of components to plot.</p></li>
<li><p><strong>selected</strong> (<em>Optional</em><em>[</em><em>List</em><em>[</em><em>int</em><em>]</em><em>]</em><em>, </em><em>default None</em>) – Number of components to highlight in the plot.</p></li>
<li><p><strong>show_cumulative</strong> (<em>bool</em><em>, </em><em>default True</em>) – Whether to show the cumulative variance explained in a second y-axis.</p></li>
<li><p><strong>n_thresh</strong> (<em>Optional</em><em>[</em><em>int</em><em>]</em><em>, </em><em>default None</em>) – Enables a vertical threshold line.</p></li>
<li><p><strong>corr_plot</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Enable correlation plot. Shows highest absolute correlation for each bar.</p></li>
<li><p><strong>corr_on</strong> (<em>Literal</em><em>[</em><em>&quot;obs&quot;</em><em>, </em><em>&quot;var&quot;</em><em>]</em><em>, </em><em>default &quot;obs&quot;</em>) – Calculate correlation on either observations (adata.obs) or variables (adata.var).</p></li>
<li><p><strong>corr_thresh</strong> (<em>Optional</em><em>[</em><em>float</em><em>]</em><em>, </em><em>default None</em>) – Enables a red threshold line in the lower plot.</p></li>
<li><p><strong>ax</strong> (<em>Optional</em><em>[</em><em>matplotlib.axes.Axes</em><em>]</em><em>, </em><em>default None</em>) – Axes object to plot on. If None, a new figure is created.</p></li>
<li><p><strong>save</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em><em> (</em><em>not saved</em><em>)</em>) – Filename to save the figure. If None, the figure is not saved.</p></li>
<li><p><strong>sel_col</strong> (<em>str</em><em>, </em><em>default &quot;grey&quot;</em>) – Bar color of selected bars.</p></li>
<li><p><strong>om_col</strong> (<em>str</em><em>, </em><em>default &quot;lightgrey&quot;</em>) – Bar color of omitted bars.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Axes object containing the plot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.axes.Axes</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>KeyError</strong> – If the given method is not found in adata.uns.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">plot_pca_variance</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s2">&quot;pca&quot;</span><span class="p">,</span>
              <span class="n">n_pcs</span><span class="o">=</span><span class="mi">20</span><span class="p">,</span>
              <span class="n">selected</span><span class="o">=</span><span class="p">[</span><span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">9</span><span class="p">],</span>
              <span class="n">corr_plot</span><span class="o">=</span><span class="s2">&quot;spearmanr&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-23.png" class="plot-directive" src="../_images/plotting-23.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.embedding.plot_pca_correlation">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.embedding.</span></span><span class="sig-name descname"><span class="pre">plot_pca_correlation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">which</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'obs'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'var'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'obs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">basis</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'pca'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_components</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">10</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">pvalue_threshold</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.01</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'spearmanr'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'pearsonr'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'spearmanr'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">plot_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'corrcoefs'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'pvalues'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'corrcoefs'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Axes</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/embedding.html#plot_pca_correlation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.embedding.plot_pca_correlation" title="Link to this definition"></a></dt>
<dd><p>Plot a heatmap of the correlation between dimensionality reduction coordinates (e.g. umap or pca) and the given columns.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>sc.AnnData</em>) – Annotated data matrix object.</p></li>
<li><p><strong>which</strong> (<em>Literal</em><em>[</em><em>&quot;obs&quot;</em><em>, </em><em>&quot;var&quot;</em><em>]</em><em>, </em><em>default &quot;obs&quot;</em>) – Whether to use the observations (“obs”) or variables (“var”) for the correlation.</p></li>
<li><p><strong>basis</strong> (<em>str</em><em>, </em><em>default &quot;pca&quot;</em>) – Dimensionality reduction to calculate correlation with. Must be a key in adata.obsm, or a basis available as “X_&lt;basis&gt;” such as “umap”, “tsne” or “pca”.</p></li>
<li><p><strong>n_components</strong> (<em>int</em><em>, </em><em>default 10</em>) – Number of components to use for the correlation.</p></li>
<li><p><strong>columns</strong> (<em>Optional</em><em>[</em><em>list</em><em>[</em><em>str</em><em>]</em><em>]</em><em>, </em><em>default None</em>) – List of columns to use for the correlation. If None, all numeric columns are used.</p></li>
<li><p><strong>pvalue_threshold</strong> (<em>float</em><em>, </em><em>default 0.01</em>) – Threshold for significance of correlation. If the p-value is below this threshold, a star is added to the heatmap.</p></li>
<li><p><strong>method</strong> (<em>Literal</em><em>[</em><em>&quot;spearmanr&quot;</em><em>, </em><em>&quot;pearson&quot;</em><em>]</em><em>, </em><em>default &quot;spearmanr&quot;</em>) – Method to use for correlation. Must be either “pearsonr” or “spearmanr”.</p></li>
<li><p><strong>plot_values</strong> (<em>Literal</em><em>[</em><em>&quot;corrcoefs&quot;</em><em>, </em><em>&quot;pvalues&quot;</em><em>]</em><em>, </em><em>default &quot;corrcoefs&quot;</em>) – Values which will be used to plot the heatmap, either “corrcoefs” (correlation coefficients) or “pvalues”. P-values will be shown as
<cite>np.sign(corrcoefs)*np.log10(p-value)</cite>, the logged p-value with the sign of the corresponding correlation coefficient.</p></li>
<li><p><strong>figsize</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em>, </em><em>int</em><em>]</em><em>]</em><em>, </em><em>default None</em>) – Size of the figure in inches. If None, the size is automatically determined.</p></li>
<li><p><strong>title</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Title of the plot. If None, no title is added.</p></li>
<li><p><strong>save</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Filename to save the figure.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional keyword arguments are passed to <code class="xref py py-func docutils literal notranslate"><span class="pre">seaborn.heatmap()</span></code>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong> – Axes object containing the heatmap.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.axes.Axes</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">plot_pca_correlation</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">which</span><span class="o">=</span><span class="s2">&quot;obs&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-24.png" class="plot-directive" src="../_images/plotting-24.png" />
</figure>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">plot_pca_correlation</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">basis</span><span class="o">=</span><span class="s2">&quot;umap&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-25.png" class="plot-directive" src="../_images/plotting-25.png" />
</figure>
</dd></dl>

</section>
<hr class="docutils" />
<section id="module-sctoolbox.plotting.clustering">
<span id="clustering"></span><h2>clustering<a class="headerlink" href="#module-sctoolbox.plotting.clustering" title="Link to this heading"></a></h2>
<p>Functions for plotting clustering results e.g. UMAPs colored by clusters.</p>
<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.clustering.search_clustering_parameters">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.clustering.</span></span><span class="sig-name descname"><span class="pre">search_clustering_parameters</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">method</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'leiden'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'louvain'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'leiden'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">resolution_range</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">(0.1,</span> <span class="pre">1,</span> <span class="pre">0.1)</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">embedding</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'X_umap'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">verbose</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/clustering.html#search_clustering_parameters"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.clustering.search_clustering_parameters" title="Link to this definition"></a></dt>
<dd><p>Plot a grid of different resolution parameters for clustering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>sc.AnnData</em>) – Annotated data matrix object.</p></li>
<li><p><strong>method</strong> (<em>str</em><em>, </em><em>default: &quot;leiden&quot;</em>) – Clustering method to use. Can be one of ‘leiden’ or ‘louvain’.</p></li>
<li><p><strong>resolution_range</strong> (<em>Tuple</em><em>[</em><em>float</em><em> | </em><em>int</em><em>, </em><em>float</em><em> | </em><em>int</em><em>, </em><em>float</em><em> | </em><em>int</em><em>]</em><em>, </em><em>default:</em><em> (</em><em>0.1</em><em>, </em><em>1</em><em>, </em><em>0.1</em><em>)</em>) – Range of ‘resolution’ parameter values to test. Must be a tuple in the form (min, max, step).</p></li>
<li><p><strong>embedding</strong> (<em>str</em><em>, </em><em>default: &quot;X_umap&quot;.</em>) – Embedding method to use. Must be a key in adata.obsm. If not, will try to use f”X_{embedding}”.</p></li>
<li><p><strong>ncols</strong> (<em>int</em><em>, </em><em>default: 3</em>) – Number of columns in the grid.</p></li>
<li><p><strong>verbose</strong> (<em>bool</em><em>, </em><em>default: True</em>) – Print progress to console.</p></li>
<li><p><strong>save</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Path to save figure.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Keyword arguments to be passed to sc.pl.embedding.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>axarr</strong> – Array of axes objects containing the plot(s).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><ul class="simple">
<li><p><strong>ValueError</strong> – If step is lager than max - min</p></li>
<li><p><strong>KeyError</strong> – If embedding is not found in adata.obsm.</p></li>
</ul>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">search_clustering_parameters</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">method</span><span class="o">=</span><span class="s1">&#39;louvain&#39;</span><span class="p">,</span> <span class="n">resolution_range</span><span class="o">=</span><span class="p">(</span><span class="mf">0.1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mf">0.2</span><span class="p">),</span> <span class="n">embedding</span><span class="o">=</span><span class="s1">&#39;X_umap&#39;</span><span class="p">,</span> <span class="n">ncols</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">verbose</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-26.png" class="plot-directive" src="../_images/plotting-26.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.clustering.marker_gene_clustering">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.clustering.</span></span><span class="sig-name descname"><span class="pre">marker_gene_clustering</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">marker_genes_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_umap</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/clustering.html#marker_gene_clustering"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.clustering.marker_gene_clustering" title="Link to this definition"></a></dt>
<dd><p>Plot an overview of marker genes and clustering.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>sc.AnnData</em>) – Annotated data matrix.</p></li>
<li><p><strong>groupby</strong> (<em>str</em>) – Key in <cite>adata.obs</cite> for which to plot the clustering.</p></li>
<li><p><strong>marker_genes_dict</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>list</em><em>[</em><em>str</em><em>]</em><em>]</em>) – Dictionary of marker genes to plot. Keys are the names of the groups and values are lists of marker genes.</p></li>
<li><p><strong>show_umap</strong> (<em>bool</em><em>, </em><em>default: True</em>) – Whether to show a UMAP plot on the left.</p></li>
<li><p><strong>save</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default: None</em>) – If given, save the figure to this path.</p></li>
<li><p><strong>figsize</strong> (<em>Tuple</em><em>[</em><em>float</em><em> | </em><em>int</em><em>, </em><em>float</em><em> | </em><em>int</em><em>]</em><em>, </em><em>default: None</em>) – Size of the figure. If <cite>None</cite>, use default size.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Keyword arguments to be passed to sc.pl.dotplot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>axarr</strong> – List of axes objects containing the plot(s).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">marker_genes_dict</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;S&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;PCNA&quot;</span><span class="p">],</span> <span class="s2">&quot;G2M&quot;</span><span class="p">:</span> <span class="p">[</span><span class="s2">&quot;HMGB2&quot;</span><span class="p">]}</span>

<span class="n">pl</span><span class="o">.</span><span class="n">marker_gene_clustering</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="s2">&quot;phase&quot;</span><span class="p">,</span> <span class="n">marker_genes_dict</span><span class="p">,</span> <span class="n">show_umap</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">save</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-27.png" class="plot-directive" src="../_images/plotting-27.png" />
</figure>
</dd></dl>

</section>
<hr class="docutils" />
<section id="module-sctoolbox.plotting.marker_genes">
<span id="marker-genes"></span><h2>marker_genes<a class="headerlink" href="#module-sctoolbox.plotting.marker_genes" title="Link to this heading"></a></h2>
<p>Plots for marker genes e.g. as results of sc.tl.rank_genes_groups.</p>
<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.marker_genes.rank_genes_plot">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.marker_genes.</span></span><span class="sig-name descname"><span class="pre">rank_genes_plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">key</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'rank_genes_groups'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">genes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">n_genes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">15</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dendrogram</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">style</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'dots'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'heatmap'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'dots'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">measure</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'expression'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">dict</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/marker_genes.html#rank_genes_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.marker_genes.rank_genes_plot" title="Link to this definition"></a></dt>
<dd><p>Plot expression of genes from rank_genes_groups or from a gene list/dict.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>sc.AnnData</em>) – Annotated data matrix.</p></li>
<li><p><strong>key</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default &quot;rank_genes_groups&quot;</em>) – Key from <cite>adata.uns</cite> to plot. For example, <cite>rank_genes_groups</cite> or <cite>rank_genes_groups_filtered</cite>.</p></li>
<li><p><strong>genes</strong> (<em>Optional</em><em>[</em><em>list</em><em>[</em><em>str</em><em>] </em><em>| </em><em>dict</em><em>[</em><em>str</em><em>, </em><em>list</em><em>[</em><em>str</em><em>]</em><em>]</em><em>]</em><em>, </em><em>default None</em>) – List of genes to plot across groups in ‘groupby’. If a dict is passed, the keys are the group names and the values are lists of genes. Setting ‘genes’ overrides the ‘key’ parameter.</p></li>
<li><p><strong>n_genes</strong> (<em>int</em><em>, </em><em>default 15</em>) – Number of genes to plot if <cite>key</cite> is specified.</p></li>
<li><p><strong>dendrogram</strong> (<em>bool</em><em>, </em><em>default False</em>) – Whether to show the dendrogram for groups.</p></li>
<li><p><strong>groupby</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Key from <cite>adata.obs</cite> to group cells by.</p></li>
<li><p><strong>title</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Title for the plot.</p></li>
<li><p><strong>style</strong> (<em>Literal</em><em>[</em><em>&quot;dots&quot;</em><em>, </em><em>&quot;heatmap&quot;</em><em>]</em><em>, </em><em>default &quot;dots&quot;</em>) – Style of the plot. Either <cite>dots</cite> or <cite>heatmap</cite>.</p></li>
<li><p><strong>measure</strong> (<em>str</em><em>, </em><em>default &quot;expression&quot;</em>) – Measure to write in colorbar label. For example, <cite>expression</cite> or <cite>accessibility</cite>.</p></li>
<li><p><strong>save</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – If given, save the figure to this path.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional arguments passed to <cite>sc.pl.rank_genes_groups_dotplot</cite> or <cite>sc.pl.rank_genes_groups_matrixplot</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – <ol class="arabic simple">
<li><p>If <cite>style</cite> is not one of <cite>dots</cite> or <cite>heatmap</cite>
    2. If <cite>groupby</cite> is not specified when <cite>genes</cite> is specified.</p></li>
</ol>
</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>g</strong> – Dictionary containing the matplotlib axes objects for the plot.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>dict</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">rank_genes_plot</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">n_genes</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-28.png" class="plot-directive" src="../_images/plotting-28.png" />
</figure>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">rank_genes_plot</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">genes</span><span class="o">=</span><span class="p">{</span><span class="s2">&quot;group1&quot;</span><span class="p">:</span> <span class="n">adata</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="mi">10</span><span class="p">],</span> <span class="s2">&quot;group2&quot;</span><span class="p">:</span> <span class="n">adata</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">10</span><span class="p">:</span><span class="mi">20</span><span class="p">]},</span> <span class="n">groupby</span><span class="o">=</span><span class="s2">&quot;bulk_labels&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-29.png" class="plot-directive" src="../_images/plotting-29.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.marker_genes.grouped_violin">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.marker_genes.</span></span><span class="sig-name descname"><span class="pre">grouped_violin</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">style</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'violin'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'boxplot'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'bar'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'violin'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">normalize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Axes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Axes</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/marker_genes.html#grouped_violin"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.marker_genes.grouped_violin" title="Link to this definition"></a></dt>
<dd><p>Create violinplot of values across cells in an adata object grouped by x and ‘groupby’.</p>
<p>Can for example show the expression of one gene across groups (x = obs_group, y = gene),
expression of multiple genes grouped by cell type (x = gene_list, groupby = obs_cell_type),
or values from adata.obs across cells (x = obs_group, y = obs_column).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>sc.AnnData</em>) – Annotated data matrix.</p></li>
<li><p><strong>x</strong> (<em>str</em><em> | </em><em>list</em><em>[</em><em>str</em><em>]</em>) – Column name in adata.obs or gene name(s) in adata.var.index to group by on the x-axis. Multiple gene names can be given in a list.</p></li>
<li><p><strong>y</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – A column name in adata.obs or a gene in adata.var.index to plot values for. Only needed if x is a column in adata.obs.</p></li>
<li><p><strong>groupby</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Column name in adata.obs to create grouped violins. If None, a single violin is plotted per group in ‘x’.</p></li>
<li><p><strong>figsize</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em> | </em><em>float</em><em>, </em><em>int</em><em> | </em><em>float</em><em>]</em><em>]</em><em>, </em><em>default None</em>) – Figure size.</p></li>
<li><p><strong>title</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Title of the plot. If None, no title is shown.</p></li>
<li><p><strong>style</strong> (<em>Literal</em><em>[</em><em>&quot;violin&quot;</em><em>, </em><em>&quot;boxplot&quot;</em><em>, </em><em>&quot;bar&quot;</em><em>]</em><em>, </em><em>default &quot;violin&quot;</em>) – Plot style. Either “violin” or “boxplot” or “bar”.</p></li>
<li><p><strong>normalize</strong> (<em>bool</em><em>, </em><em>default False</em>) – If True, normalize the values in ‘y’ to the range [0, 1] per group in ‘x’.</p></li>
<li><p><strong>ax</strong> (<em>Optional</em><em>[</em><em>matplotlib.axes.Axes</em><em>]</em><em>, </em><em>default None</em>) – A matplotlib axes object to plot violinplots in. If None, a new figure and axes is created.</p></li>
<li><p><strong>save</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Path to save the figure to. If None, the figure is not saved.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional arguments passed to seaborn.violinplot or seaborn.boxplot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>matplotlib.axes.Axes</p>
</dd>
<dt class="field-odd">Raises<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>ValueError</strong> – If x or y are not columns in adata.obs or a genes in adata.var.index.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">grouped_violin</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="s1">&#39;phase&#39;</span><span class="p">,</span> <span class="n">y</span><span class="o">=</span><span class="s1">&#39;G2M_score&#39;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-30.png" class="plot-directive" src="../_images/plotting-30.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.marker_genes.group_expression_boxplot">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.marker_genes.</span></span><span class="sig-name descname"><span class="pre">group_expression_boxplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Axes</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/marker_genes.html#group_expression_boxplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.marker_genes.group_expression_boxplot" title="Link to this definition"></a></dt>
<dd><p>Plot a boxplot showing summarized gene expression of genes in <cite>gene_list</cite> across the groups in <cite>groupby</cite>.</p>
<p>The total gene expression is quantile normalized per group, and are subsequently normalized to 0-1 per gene across groups.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>sc.AnnData</em>) – An annotated data matrix object containing counts in .X.</p></li>
<li><p><strong>gene_list</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – A list of genes to show expression for.</p></li>
<li><p><strong>groupby</strong> (<em>str</em>) – A column in .obs for grouping cells into groups on the x-axis</p></li>
<li><p><strong>figsize</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em> | </em><em>float</em><em>, </em><em>int</em><em> | </em><em>float</em><em>]</em><em>]</em><em>, </em><em>default None</em><em> (</em><em>matplotlib default</em><em>)</em>) – Control the size of the output figure, e.g. (6,10).</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional arguments passed to seaborn.boxplot.</p></li>
</ul>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>matplotlib.axes.Axes</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gene_list</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;HES4&quot;</span><span class="p">,</span> <span class="s2">&quot;PRMT2&quot;</span><span class="p">,</span> <span class="s2">&quot;ITGB2&quot;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">group_expression_boxplot</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">gene_list</span><span class="p">,</span> <span class="n">groupby</span><span class="o">=</span><span class="s2">&quot;bulk_labels&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-31.png" class="plot-directive" src="../_images/plotting-31.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.marker_genes.gene_expression_heatmap">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.marker_genes.</span></span><span class="sig-name descname"><span class="pre">gene_expression_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">genes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_name_column</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">groupby</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">row_cluster</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">col_cluster</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_row_dendrogram</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_col_dendrogram</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Any</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/marker_genes.html#gene_expression_heatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.marker_genes.gene_expression_heatmap" title="Link to this definition"></a></dt>
<dd><p>Plot a heatmap of z-score normalized gene expression across clusters/groups.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>sc.AnnData</em>) – Annotated data matrix.</p></li>
<li><p><strong>genes</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of genes to plot. Must match names in <cite>adata.var.index</cite>.</p></li>
<li><p><strong>cluster_column</strong> (<em>str</em>) – Key in <cite>adata.obs</cite> for which to cluster the x-axis.</p></li>
<li><p><strong>gene_name_column</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Column in <cite>adata.var</cite> for which to use for gene row names. Default is to use the .var index.</p></li>
<li><p><strong>title</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Title of the plot.</p></li>
<li><p><strong>groupby</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Key in <cite>adata.obs</cite> for which to plot a colorbar per cluster.</p></li>
<li><p><strong>row_cluster</strong> (<em>bool</em><em>, </em><em>default True</em>) – Whether to cluster the rows.</p></li>
<li><p><strong>col_cluster</strong> (<em>bool</em><em>, </em><em>default False</em>) – Whether to cluster the columns.</p></li>
<li><p><strong>show_row_dendrogram</strong> (<em>bool</em><em>, </em><em>default False</em>) – Whether to show the dendrogram for the rows.</p></li>
<li><p><strong>show_col_dendrogram</strong> (<em>bool</em><em>, </em><em>default False</em>) – Whether to show the dendrogram for the columns.</p></li>
<li><p><strong>figsize</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em> | </em><em>float</em><em>, </em><em>int</em><em> | </em><em>float</em><em>]</em><em>]</em><em>, </em><em>default None</em>) – Size of the figure. If <cite>None</cite>, use default size.</p></li>
<li><p><strong>save</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – If given, save the figure to this path.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional arguments passed to <cite>seaborn.clustermap</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>g</strong> – sns.matrix.ClusterGrid: The seaborn ClusterGrid object containing the heatmap.
Note: Any since sns.matrix.ClusterGrid cannot be checked by beartype.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Any</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>KeyError</strong> – If <cite>gene_name_column</cite> is not a column in <cite>adata.var</cite>.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;samples&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s2">&quot;CTRL1&quot;</span><span class="p">,</span> <span class="s2">&quot;CTRL2&quot;</span><span class="p">,</span> <span class="s2">&quot;CTRL3&quot;</span><span class="p">,</span> <span class="s2">&quot;CTRL4&quot;</span><span class="p">,</span> <span class="s2">&quot;TREAT1&quot;</span><span class="p">,</span> <span class="s2">&quot;TREAT2&quot;</span><span class="p">,</span> <span class="s2">&quot;TREAT3&quot;</span><span class="p">,</span> <span class="s2">&quot;TREAT4&quot;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="n">adata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;condition&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;samples&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">extract</span><span class="p">(</span><span class="s2">&quot;([A-Z]+)&quot;</span><span class="p">)</span>

<span class="n">genes</span> <span class="o">=</span> <span class="n">adata</span><span class="o">.</span><span class="n">var</span><span class="o">.</span><span class="n">index</span><span class="p">[:</span><span class="mi">15</span><span class="p">]</span>
<span class="n">pl</span><span class="o">.</span><span class="n">gene_expression_heatmap</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">genes</span><span class="p">,</span> <span class="n">cluster_column</span><span class="o">=</span><span class="s2">&quot;samples&quot;</span><span class="p">,</span>
                           <span class="n">groupby</span><span class="o">=</span><span class="s2">&quot;condition&quot;</span><span class="p">,</span>
                           <span class="n">title</span><span class="o">=</span><span class="s2">&quot;Gene expression&quot;</span><span class="p">,</span>
                           <span class="n">col_cluster</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">show_col_dendrogram</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span>
                           <span class="n">colors_ratio</span><span class="o">=</span><span class="mf">0.03</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-32.png" class="plot-directive" src="../_images/plotting-32.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.marker_genes.plot_differential_genes">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.marker_genes.</span></span><span class="sig-name descname"><span class="pre">plot_differential_genes</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">rank_table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'Differentially</span> <span class="pre">expressed</span> <span class="pre">genes'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Axes</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/marker_genes.html#plot_differential_genes"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.marker_genes.plot_differential_genes" title="Link to this definition"></a></dt>
<dd><p>Plot number of differentially expressed genes per contrast in a barplot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>rank_table</strong> (<em>pd.DataFrame</em>) – Output of sctoolbox.tools.marker_genes.pairwise_rank_genes.</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>default &quot;Differentially expressed genes&quot;</em>) – Title of the plot.</p></li>
<li><p><strong>save</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – If given, save the figure to this path.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Keyword arguments passed to pl.bidirectional_barplot.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If no significant differentially expressed genes are found in the data.</p>
</dd>
<dt class="field-odd">Returns<span class="colon">:</span></dt>
<dd class="field-odd"><p>Axes object.</p>
</dd>
<dt class="field-even">Return type<span class="colon">:</span></dt>
<dd class="field-even"><p>matplotlib.axes.Axes</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sctoolbox.tools</span> <span class="k">as</span> <span class="nn">tl</span>
<span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">[</span><span class="s2">&quot;groups&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">choice</span><span class="p">([</span><span class="s2">&quot;G1&quot;</span><span class="p">,</span> <span class="s2">&quot;G2&quot;</span><span class="p">,</span> <span class="s2">&quot;G3&quot;</span><span class="p">],</span> <span class="n">size</span><span class="o">=</span><span class="n">adata</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>
<span class="n">pairwise_table</span> <span class="o">=</span> <span class="n">tl</span><span class="o">.</span><span class="n">marker_genes</span><span class="o">.</span><span class="n">pairwise_rank_genes</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="n">foldchange_threshold</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span> <span class="n">groupby</span><span class="o">=</span><span class="s2">&quot;groups&quot;</span><span class="p">)</span>

<span class="n">pl</span><span class="o">.</span><span class="n">plot_differential_genes</span><span class="p">(</span><span class="n">pairwise_table</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-33.png" class="plot-directive" src="../_images/plotting-33.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.marker_genes.plot_gene_correlation">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.marker_genes.</span></span><span class="sig-name descname"><span class="pre">plot_gene_correlation</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ref_gene</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">gene_list</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ncols</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">3</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">Axes</span><span class="p"><span class="pre">]</span></span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/marker_genes.html#plot_gene_correlation"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.marker_genes.plot_gene_correlation" title="Link to this definition"></a></dt>
<dd><p>Plot the gene expression of one reference gene against the expression of a set of genes.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>sc.AnnData</em>) – An annotated data matrix object containing counts in .X.</p></li>
<li><p><strong>ref_gene</strong> (<em>str</em>) – Reference gene to which other genes are comapred to.</p></li>
<li><p><strong>gene_list</strong> (<em>list</em><em>[</em><em>str</em><em>] </em><em>| </em><em>str</em>) – A list of genes to show expression for.</p></li>
<li><p><strong>ncols</strong> (<em>int</em><em>, </em><em>default 3</em>) – Number of columns in plot grid.</p></li>
<li><p><strong>figsize</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em> | </em><em>float</em><em>, </em><em>int</em><em> | </em><em>float</em><em>]</em><em>]</em><em>, </em><em>default None</em>) – Control the size of the output figure, e.g. (6,10).</p></li>
<li><p><strong>save</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Save the figure to a file.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional arguments passed to seaborn.regplot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List containing all axis objects.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>Iterable[matplotlib.axes.Axes]</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">gene_list</span><span class="o">=</span><span class="p">(</span><span class="s2">&quot;HES4&quot;</span><span class="p">,</span> <span class="s2">&quot;PRMT2&quot;</span><span class="p">,</span> <span class="s2">&quot;ITGB2&quot;</span><span class="p">)</span>
<span class="n">pl</span><span class="o">.</span><span class="n">plot_gene_correlation</span><span class="p">(</span><span class="n">adata</span><span class="p">,</span> <span class="s2">&quot;SUMO3&quot;</span><span class="p">,</span> <span class="n">gene_list</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-34.png" class="plot-directive" src="../_images/plotting-34.png" />
</figure>
</dd></dl>

</section>
<hr class="docutils" />
<section id="module-sctoolbox.plotting.genometracks">
<span id="genometracks"></span><h2>genometracks<a class="headerlink" href="#module-sctoolbox.plotting.genometracks" title="Link to this heading"></a></h2>
<p>Class to create a genome track plot via pyGenomeTracks.</p>
<dl class="py class">
<dt class="sig sig-object py" id="sctoolbox.plotting.genometracks.GenomeTracks">
<em class="property"><span class="pre">class</span><span class="w"> </span></em><span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.genometracks.</span></span><span class="sig-name descname"><span class="pre">GenomeTracks</span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/genometracks.html#GenomeTracks"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.genometracks.GenomeTracks" title="Link to this definition"></a></dt>
<dd><p>Bases: <code class="xref py py-class docutils literal notranslate"><span class="pre">object</span></code></p>
<p>Class for creating a genome track plot via pyGenomeTracks by collecting different tracks and writing the .ini file.</p>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">sctoolbox.plotting</span> <span class="k">as</span> <span class="nn">pl</span>

<span class="n">G</span> <span class="o">=</span> <span class="n">pl</span><span class="o">.</span><span class="n">GenomeTracks</span><span class="p">()</span>

<span class="c1">#Add bigwig tracks</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_track</span><span class="p">(</span><span class="s2">&quot;data/tracks/bigwig1.bw&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_track</span><span class="p">(</span><span class="s2">&quot;data/tracks/bigwig2.bw&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;inverted&quot;</span><span class="p">)</span>

<span class="c1">#Add hlines to previous bigwig track</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_hlines</span><span class="p">([</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;red&quot;</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_hlines</span><span class="p">([</span><span class="mi">250</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;blue&quot;</span><span class="p">,</span> <span class="n">line_style</span><span class="o">=</span><span class="s2">&quot;dashed&quot;</span><span class="p">)</span>

<span class="c1">#Add links</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_track</span><span class="p">(</span><span class="s2">&quot;data/tracks/links.arcs&quot;</span><span class="p">,</span> <span class="n">orientation</span><span class="o">=</span><span class="s2">&quot;inverted&quot;</span><span class="p">)</span>

<span class="c1">#Add one line between tracks</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_hline</span><span class="p">()</span>

<span class="c1">#Add .bed-file regions</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_track</span><span class="p">(</span><span class="s2">&quot;data/tracks/tad_classification.bed&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;bed&quot;</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_track</span><span class="p">(</span><span class="s2">&quot;data/tracks/tad_classification.bed&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;Reds&quot;</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="s2">&quot;bed colored by score column&quot;</span><span class="p">)</span>

<span class="c1">#Add vlines and highlight</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_track</span><span class="p">(</span><span class="s2">&quot;data/tracks/vlines.bed&quot;</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="s2">&quot;vlines&quot;</span><span class="p">)</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_track</span><span class="p">(</span><span class="s2">&quot;data/tracks/vhighlight.bed&quot;</span><span class="p">,</span> <span class="n">file_type</span><span class="o">=</span><span class="s2">&quot;vhighlight&quot;</span><span class="p">)</span>

<span class="c1">#Add a spacer</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_spacer</span><span class="p">()</span>

<span class="c1">#Add genes</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_track</span><span class="p">(</span><span class="s2">&quot;data/tracks/genes.gtf&quot;</span><span class="p">,</span> <span class="n">gene_rows</span><span class="o">=</span><span class="mi">5</span><span class="p">)</span>

<span class="c1">#Add x-axis</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_spacer</span><span class="p">()</span>
<span class="n">G</span><span class="o">.</span><span class="n">add_xaxis</span><span class="p">()</span>

<span class="c1"># Plot</span>
<span class="n">G</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">region</span><span class="o">=</span><span class="s2">&quot;X:3000000-3500000&quot;</span><span class="p">,</span> <span class="n">output</span><span class="o">=</span><span class="s2">&quot;genometrack_X.png&quot;</span><span class="p">,</span> <span class="n">trackLabelFraction</span><span class="o">=</span><span class="mf">0.2</span><span class="p">)</span>
</pre></div>
</div>
<img alt="../_images/genometrack_X.png" src="../_images/genometrack_X.png" />
<dl class="py method">
<dt class="sig sig-object py" id="sctoolbox.plotting.genometracks.GenomeTracks.add_track">
<span class="sig-name descname"><span class="pre">add_track</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">file_type</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">name</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sctoolbox/plotting/genometracks.html#GenomeTracks.add_track"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.genometracks.GenomeTracks.add_track" title="Link to this definition"></a></dt>
<dd><p>Add a track to the GenomeTracks object.</p>
<p>The track will be added to the configuration file as one element, e.g. .add_track(“file1.bed”, file_type=”bed”, name=”my_bed”) will add the following to the configuration file:
<code class="docutils literal notranslate"><span class="pre">`</span>
<span class="pre">[my_bed]</span>
<span class="pre">file</span> <span class="pre">=</span> <span class="pre">file1.bed</span>
<span class="pre">file_type</span> <span class="pre">=</span> <span class="pre">bed</span>
<span class="pre">`</span></code></p>
<p>Additional parameters are decided by &lt;obj&gt;.global_defaults and &lt;obj&gt;.type_defaults, or can be given by kwargs. All options and parameters are available at:
<a class="reference external" href="https://pygenometracks.readthedocs.io/en/latest/content/all_tracks.html">https://pygenometracks.readthedocs.io/en/latest/content/all_tracks.html</a></p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>file</strong> (<em>str</em>) – Path to the file containing information to be plotted. Can be .bed, .bw, .gtf etc.</p></li>
<li><p><strong>file_type</strong> (<em>str</em><em>, </em><em>default None</em>) – Specify the ‘file_type’ argument for pyGenomeTracks. If None, the type will be predicted from the file ending.</p></li>
<li><p><strong>name</strong> (<em>str</em><em>, </em><em>default None</em>) – Name of the track. If None, the name will be estimated from the file_type e.g. ‘bigwig 1’. or ‘bed 2’. If the file_type is not available, the name will be the file path.</p></li>
<li><p><strong>**kwargs</strong> (<em>arguments</em>) – Additional arguments to be passed to pyGenomeTracks track configuration, for example <cite>height=5</cite> or <cite>title=”My track”</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the file_type is not valid.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sctoolbox.plotting.genometracks.GenomeTracks.add_hlines">
<span class="sig-name descname"><span class="pre">add_hlines</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">y_values</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Iterable</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">overlay_previous</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'share-y'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'no'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'share-y'</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sctoolbox/plotting/genometracks.html#GenomeTracks.add_hlines"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.genometracks.GenomeTracks.add_hlines" title="Link to this definition"></a></dt>
<dd><p>Add horizontal lines to the previous plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>y_values</strong> (<em>list</em><em> of </em><em>int</em><em> or </em><em>float</em>) – List of y values to plot horizontal lines at.</p></li>
<li><p><strong>overlay_previous</strong> (<em>str</em><em>, </em><em>default &quot;share-y&quot;</em>) – Whether to plot the lines on the same y-axis as the previous plot (“share-y”) or on a new y-axis (“no”).</p></li>
<li><p><strong>**kwargs</strong> (<em>arguments</em>) – Additional arguments to be passed to pyGenomeTracks track configuration, for example <cite>title=”My lines”</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sctoolbox.plotting.genometracks.GenomeTracks.add_hline">
<span class="sig-name descname"><span class="pre">add_hline</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">line_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sctoolbox/plotting/genometracks.html#GenomeTracks.add_hline"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.genometracks.GenomeTracks.add_hline" title="Link to this definition"></a></dt>
<dd><p>Add a horizontal line between tracks, not within a track.</p>
<p>Can be used to visually separate tracks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>height</strong> (<em>int</em><em>, </em><em>default 1</em>) – Height of the track with the line in the middle.</p></li>
<li><p><strong>line_width</strong> (<em>int</em><em>, </em><em>default 2</em>) – Width of the line.</p></li>
<li><p><strong>**kwargs</strong> (<em>arguments</em>) – Additional arguments to be passed to pyGenomeTracks track configuration, for example <cite>title=”A line”</cite>.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sctoolbox.plotting.genometracks.GenomeTracks.add_spacer">
<span class="sig-name descname"><span class="pre">add_spacer</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sctoolbox/plotting/genometracks.html#GenomeTracks.add_spacer"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.genometracks.GenomeTracks.add_spacer" title="Link to this definition"></a></dt>
<dd><p>Add a spacer between tracks.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><p><strong>height</strong> (<em>int</em><em>, </em><em>default 1</em>) – Height of the spacer track.</p>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sctoolbox.plotting.genometracks.GenomeTracks.add_xaxis">
<span class="sig-name descname"><span class="pre">add_xaxis</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">1</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sctoolbox/plotting/genometracks.html#GenomeTracks.add_xaxis"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.genometracks.GenomeTracks.add_xaxis" title="Link to this definition"></a></dt>
<dd><p>Add the x-axis to the plot.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>height</strong> (<em>int</em><em>, </em><em>default 1</em>) – Height of the x-axis track.</p></li>
<li><p><strong>**kwargs</strong> (<em>arguments</em>) – Additional arguments to be passed to pyGenomeTracks track configuration.</p></li>
</ul>
</dd>
</dl>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sctoolbox.plotting.genometracks.GenomeTracks.show_plot">
<span class="sig-name descname"><span class="pre">show_plot</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sctoolbox/plotting/genometracks.html#GenomeTracks.show_plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.genometracks.GenomeTracks.show_plot" title="Link to this definition"></a></dt>
<dd><p>Display the plot.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sctoolbox.plotting.genometracks.GenomeTracks.show_config">
<span class="sig-name descname"><span class="pre">show_config</span></span><span class="sig-paren">(</span><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sctoolbox/plotting/genometracks.html#GenomeTracks.show_config"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.genometracks.GenomeTracks.show_config" title="Link to this definition"></a></dt>
<dd><p>Show the current configuration file as a string.</p>
</dd></dl>

<dl class="py method">
<dt class="sig sig-object py" id="sctoolbox.plotting.genometracks.GenomeTracks.plot">
<span class="sig-name descname"><span class="pre">plot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">region</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">output</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'genometracks.png'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">config_file</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dpi</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">300</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span><a class="reference internal" href="../_modules/sctoolbox/plotting/genometracks.html#GenomeTracks.plot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.genometracks.GenomeTracks.plot" title="Link to this definition"></a></dt>
<dd><p>Plot the final GenomeTracks plot based on the collected tracks.</p>
<p>Runs pyGenomeTracks with the configuration file and the given parameters, and saves the output to the given file.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>region</strong> (<em>str</em>) – Region to plot, e.g. “chr1:1000000-2000000”.</p></li>
<li><p><strong>output</strong> (<em>str</em><em>, </em><em>default &quot;genometracks.png&quot;</em>) – Path to the output file.</p></li>
<li><p><strong>config_file</strong> (<em>str</em><em>, </em><em>default None</em>) – Path to the configuration file to create. If None, a temporary file will be created in the system’s temp directory.</p></li>
<li><p><strong>title</strong> (<em>str</em><em>, </em><em>default None</em>) – Title of the plot. If None, no title will be shown.</p></li>
<li><p><strong>show</strong> (<em>bool</em><em>, </em><em>default True</em>) – If the function is run in a jupyter notebook, ‘show’ controls whether to show the plot at the end of the function run.</p></li>
<li><p><strong>dpi</strong> (<em>int</em><em>, </em><em>default 300</em>) – DPI of the plot.</p></li>
<li><p><strong>**kwargs</strong> (<em>arguments</em>) – Additional arguments to be passed to pyGenomeTracks, for example <cite>trackLabelFraction=0.2</cite>.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If the pyGenomeTracks command fails.</p>
</dd>
</dl>
</dd></dl>

</dd></dl>

</section>
<hr class="docutils" />
<section id="module-sctoolbox.plotting.velocity">
<span id="velocity"></span><h2>velocity<a class="headerlink" href="#module-sctoolbox.plotting.velocity" title="Link to this heading"></a></h2>
<p>Plot velocity related figures e.g. pseudo-time heatmap.</p>
<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.velocity.pseudotime_heatmap">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.velocity.</span></span><span class="sig-name descname"><span class="pre">pseudotime_heatmap</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">adata</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">AnnData</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">genes</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">sortby</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">layer</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">shrink_cbar</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0.5</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Axes</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/velocity.html#pseudotime_heatmap"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.velocity.pseudotime_heatmap" title="Link to this definition"></a></dt>
<dd><p>Plot heatmap of genes along pseudotime sorted by ‘sortby’ column in adata.obs.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>adata</strong> (<em>sc.AnnData</em>) – Anndata object</p></li>
<li><p><strong>genes</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of genes for heatmap.</p></li>
<li><p><strong>sortby</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Sort genes by condition</p></li>
<li><p><strong>layer</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Use different layer of anndata object.</p></li>
<li><p><strong>figsize</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em> | </em><em>float</em><em>, </em><em>int</em><em> | </em><em>float</em><em>]</em><em>]</em><em>, </em><em>default None</em>) – Tuple of integers setting the heatmap figsize.</p></li>
<li><p><strong>shrink_cbar</strong> (<em>int</em><em> | </em><em>float</em><em>, </em><em>default 0.5</em>) – Shrink color bar by set ratio.</p></li>
<li><p><strong>title</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Set title for plot.</p></li>
<li><p><strong>save</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Path and name of file to be saved.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional arguments passed to seaborn.heatmap.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ax</strong> – Axes object containing the plot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.axes.Axes</p>
</dd>
</dl>
</dd></dl>

</section>
<hr class="docutils" />
<section id="module-sctoolbox.plotting.general">
<span id="general"></span><h2>general<a class="headerlink" href="#module-sctoolbox.plotting.general" title="Link to this heading"></a></h2>
<p>General plotting functions for sctoolbox, e.g. general plots for wrappers, and saving and adding titles to figures.</p>
<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.general.clustermap_dotplot">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.general.</span></span><span class="sig-name descname"><span class="pre">clustermap_dotplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">size</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hue</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">cluster_on</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'hue'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'size'</span></span><span class="p"><span class="pre">]</span></span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'hue'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">fillna</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">0</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dend_height</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">dend_width</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">2</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">palette</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">'vlag'</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">x_rot</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">int</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">45</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_grid</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">False</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">list</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/general.html#clustermap_dotplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.general.clustermap_dotplot" title="Link to this definition"></a></dt>
<dd><p>Plot a heatmap with dots (instead of squares), which can contain the dimension of “size”.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> (<em>pd.DataFrame</em>) – Table in long-format. Has to have at least four columns as given by x, y, size and hue.</p></li>
<li><p><strong>x</strong> (<em>str</em>) – Column in table to plot on the x-axis.</p></li>
<li><p><strong>y</strong> (<em>str</em>) – Column in table to plot on the y-axis.</p></li>
<li><p><strong>size</strong> (<em>str</em>) – Column in table to use for the size of the dots.</p></li>
<li><p><strong>hue</strong> (<em>str</em>) – Column in table to use for the color of the dots.</p></li>
<li><p><strong>cluster_on</strong> (<em>Literal</em><em>[</em><em>&quot;hue&quot;</em><em>, </em><em>&quot;size&quot;</em><em>]</em><em>, </em><em>default hue</em>) – Decide which values to use for creating the dendrograms. Either “hue” or “size”.</p></li>
<li><p><strong>fillna</strong> (<em>float</em><em> | </em><em>int</em><em>, </em><em>default 0</em>) – Replace NaN with given value.</p></li>
<li><p><strong>title</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Title of the dotplot.</p></li>
<li><p><strong>figsize</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em> | </em><em>float</em><em>, </em><em>int</em><em> | </em><em>float</em><em>]</em><em>]</em><em>, </em><em>default None</em>) – Figure size in inches. Default is estimated from the number of rows/columns (ncols/3, nrows/3).</p></li>
<li><p><strong>dend_height</strong> (<em>float</em><em> | </em><em>int</em><em>, </em><em>default 2</em>) – Height of the x-axis dendrogram in counts of row elements, e.g. 2 represents a height of 2 rows in the dotplot.</p></li>
<li><p><strong>dend_width</strong> (<em>float</em><em> | </em><em>int</em><em>, </em><em>default 2</em>) – Width of the y-axis dendrogram in counts of column elements, e.g. 2 represents a width of 2 columns in the dotplot.</p></li>
<li><p><strong>palette</strong> (<em>str</em><em>, </em><em>default vlag</em>) – Color palette for hue colors.</p></li>
<li><p><strong>x_rot</strong> (<em>int</em><em>, </em><em>default 45</em>) – Rotation of xticklabels in degrees.</p></li>
<li><p><strong>show_grid</strong> (<em>bool</em><em>, </em><em>default False</em>) – Show grid behind dots in plot.</p></li>
<li><p><strong>save</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Save the figure to this path.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional arguments to pass to seaborn.scatterplot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>List of matplotlib.axes.Axes objects containing the dotplot and the dendrogram(s).</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>list</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">table</span> <span class="o">=</span> <span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[:</span><span class="mi">10</span><span class="p">]</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">clustermap_dotplot</span><span class="p">(</span>
    <span class="n">table</span><span class="o">=</span><span class="n">table</span><span class="p">,</span>
    <span class="n">x</span><span class="o">=</span><span class="s2">&quot;bulk_labels&quot;</span><span class="p">,</span>
    <span class="n">y</span><span class="o">=</span><span class="s2">&quot;index&quot;</span><span class="p">,</span>
    <span class="n">hue</span><span class="o">=</span><span class="s2">&quot;n_genes&quot;</span><span class="p">,</span>
    <span class="n">size</span><span class="o">=</span><span class="s2">&quot;n_counts&quot;</span><span class="p">,</span>
    <span class="n">palette</span><span class="o">=</span><span class="s2">&quot;viridis&quot;</span>
<span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-37.png" class="plot-directive" src="../_images/plotting-37.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.general.bidirectional_barplot">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.general.</span></span><span class="sig-name descname"><span class="pre">bidirectional_barplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">df</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">figsize</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">tuple</span><span class="p"><span class="pre">[</span></span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Axes</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/general.html#bidirectional_barplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.general.bidirectional_barplot" title="Link to this definition"></a></dt>
<dd><p>Plot a bidirectional barplot.</p>
<p>A vertical barplot where each position has one bar going left and one going right (bidirectional).</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>df</strong> (<em>pd.DataFrame</em>) – <dl class="simple">
<dt>Dataframe with the following mandatory column names:</dt><dd><ul>
<li><p>left_label</p></li>
<li><p>right_label</p></li>
<li><p>left_value</p></li>
<li><p>right_value</p></li>
</ul>
</dd>
</dl>
</p></li>
<li><p><strong>title</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Title of the plot.</p></li>
<li><p><strong>colors</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>str</em><em>]</em><em>]</em><em>, </em><em>default None</em>) – Dictionary with label names as keys and colors as values.</p></li>
<li><p><strong>figsize</strong> (<em>Optional</em><em>[</em><em>Tuple</em><em>[</em><em>int</em><em> | </em><em>float</em><em>, </em><em>int</em><em> | </em><em>float</em><em>]</em><em>]</em><em>, </em><em>default None</em>) – Figure size.</p></li>
<li><p><strong>save</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – If given, the figure will be saved to this path.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Axes containing the plot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.axes.Axes</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>KeyError</strong> – If df does not contain the required columns.</p>
</dd>
</dl>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.general.boxplot">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.general.</span></span><span class="sig-name descname"><span class="pre">boxplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">dt</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">show_median</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Axes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Axes</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/general.html#boxplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.general.boxplot" title="Link to this definition"></a></dt>
<dd><p>Generate one plot containing one box per column. The median value is shown.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>dt</strong> (<em>pd.DataFrame</em>) – pandas datafame containing numerical values in every column.</p></li>
<li><p><strong>show_median</strong> (<em>boolean</em><em>, </em><em>default True</em>) – If True show median value as small box inside the boxplot.</p></li>
<li><p><strong>ax</strong> (<em>Optional</em><em>[</em><em>matplotlib.axes.Axes</em><em>]</em><em>, </em><em>default None</em>) – Axes object to plot on. If None, a new figure is created.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional arguments to pass to seaborn.boxplot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>containing boxplot for every column.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.axes.Axes</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">randint</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">,</span><span class="n">size</span><span class="o">=</span><span class="p">(</span><span class="mi">100</span><span class="p">,</span> <span class="mi">4</span><span class="p">)),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;ABCD&#39;</span><span class="p">))</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">dt</span><span class="p">,</span> <span class="n">show_median</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-39.png" class="plot-directive" src="../_images/plotting-39.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.general.violinplot">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.general.</span></span><span class="sig-name descname"><span class="pre">violinplot</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">y</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">color_by</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">hlines</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">float</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">int</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">colors</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ax</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Axes</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">ylabel</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">bool</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">True</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">Axes</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/general.html#violinplot"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.general.violinplot" title="Link to this definition"></a></dt>
<dd><p>Plot a violinplot with optional horizontal lines for each violin.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> (<em>pd.DataFrame</em>) – Values to create the violins from.</p></li>
<li><p><strong>y</strong> (<em>str</em>) – Column name of table. Values that will be shown on y-axis.</p></li>
<li><p><strong>color_by</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Column name of table. Used to color group violins.</p></li>
<li><p><strong>hlines</strong> (<em>Optional</em><em>[</em><em>Union</em><em>[</em><em>float</em><em> | </em><em>int</em><em>, </em><em>list</em><em>[</em><em>float</em><em> | </em><em>int</em><em>]</em><em>,</em>) – dict[str, Union[float | int, list[float | int]]]]], default None
Define horizontal lines for each violin.</p></li>
<li><p><strong>colors</strong> (<em>Optional</em><em>[</em><em>list</em><em>[</em><em>str</em><em>]</em><em>]</em><em>, </em><em>default None</em>) – List of colors to use for violins.</p></li>
<li><p><strong>ax</strong> (<em>Optional</em><em>[</em><em>matplotlib.axes.Axes</em><em>]</em><em>, </em><em>default None</em>) – Axes object to draw the plot on. Otherwise use current axes.</p></li>
<li><p><strong>title</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Title of the plot.</p></li>
<li><p><strong>ylabel</strong> (<em>bool</em><em> | </em><em>str</em><em>, </em><em>default True</em>) – Boolean if ylabel should be shown. Or str for custom ylabel.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional arguments to pass to seaborn.violinplot.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Object containing the violinplot.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>matplotlib.axes.Axes</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If y or color_by is not a column name of table. Or if hlines is not a number or list of numbers for color_by=None.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
<span class="n">table</span> <span class="o">=</span> <span class="n">sns</span><span class="o">.</span><span class="n">load_dataset</span><span class="p">(</span><span class="s2">&quot;titanic&quot;</span><span class="p">)</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">violinplot</span><span class="p">(</span><span class="n">table</span><span class="p">,</span> <span class="s2">&quot;age&quot;</span><span class="p">,</span> <span class="n">color_by</span><span class="o">=</span><span class="s2">&quot;class&quot;</span><span class="p">,</span> <span class="n">hlines</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">colors</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ax</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">title</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">ylabel</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-41.png" class="plot-directive" src="../_images/plotting-41.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.general.plot_venn">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.general.</span></span><span class="sig-name descname"><span class="pre">plot_venn</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">groups_dict</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">Any</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">title</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">None</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/general.html#plot_venn"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.general.plot_venn" title="Link to this definition"></a></dt>
<dd><p>Plot a Venn diagram from a dictionary of 2-3 groups of lists.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>groups_dict</strong> (<em>dict</em><em>[</em><em>str</em><em>, </em><em>list</em><em>[</em><em>Any</em><em>]</em><em>]</em>) – A dictionary where the keys are group names (strings) and the values
are lists of items belonging to that group (e.g. {‘Group A’: [‘A’, ‘B’, ‘C’], …}).</p></li>
<li><p><strong>title</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Title of the plot.</p></li>
<li><p><strong>save</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – Filename to save the plot to.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional arguments to pass to matplotlib_venn.venn2 or matplotlib_venn.venn3.</p></li>
</ul>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – If number of groups in groups_dict is not 2 or 3.</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">venn2_example</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;Group A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">2</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">],</span>
                  <span class="s1">&#39;Group B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">3</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">,</span> <span class="mi">6</span><span class="p">]</span>
                <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">plot_venn</span><span class="p">(</span><span class="n">venn2_example</span><span class="p">,</span> <span class="s2">&quot;Simple Venn2 plot&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-43.png" class="plot-directive" src="../_images/plotting-43.png" />
</figure>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">venn3_example</span> <span class="o">=</span> <span class="p">{</span> <span class="s1">&#39;Fruits A&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Lemon&#39;</span><span class="p">,</span> <span class="s1">&#39;Orange&#39;</span><span class="p">,</span> <span class="s1">&#39;Blueberry&#39;</span><span class="p">,</span> <span class="s1">&#39;Grapefruit&#39;</span><span class="p">],</span>
                  <span class="s1">&#39;Fruits B&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Pineapple&#39;</span><span class="p">,</span> <span class="s1">&#39;Mango&#39;</span><span class="p">,</span> <span class="s1">&#39;Banana&#39;</span><span class="p">,</span> <span class="s1">&#39;Papaya&#39;</span><span class="p">,</span> <span class="s1">&#39;Blueberry&#39;</span><span class="p">,</span> <span class="s1">&#39;Strawberry&#39;</span><span class="p">],</span>
                  <span class="s1">&#39;Fruits C&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;Strawberry&#39;</span><span class="p">,</span> <span class="s1">&#39;Blueberry&#39;</span><span class="p">,</span> <span class="s1">&#39;Raspberry&#39;</span><span class="p">,</span> <span class="s1">&#39;Orange&#39;</span><span class="p">,</span> <span class="s1">&#39;Mango&#39;</span><span class="p">]</span>
                <span class="p">}</span>
</pre></div>
</div>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">pl</span><span class="o">.</span><span class="n">plot_venn</span><span class="p">(</span><span class="n">venn3_example</span><span class="p">,</span> <span class="s2">&quot;Simple Venn3 plot&quot;</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-45.png" class="plot-directive" src="../_images/plotting-45.png" />
</figure>
</dd></dl>

<dl class="py function">
<dt class="sig sig-object py" id="sctoolbox.plotting.general.pairwise_scatter">
<span class="sig-prename descclassname"><span class="pre">sctoolbox.plotting.general.</span></span><span class="sig-name descname"><span class="pre">pairwise_scatter</span></span><span class="sig-paren">(</span><em class="sig-param"><span class="n"><span class="pre">table</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">DataFrame</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">columns</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">list</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">]</span></span></span></em>, <em class="sig-param"><span class="n"><span class="pre">thresholds</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">str</span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">dict</span><span class="p"><span class="pre">[</span></span><span class="pre">Literal</span><span class="p"><span class="pre">[</span></span><span class="s"><span class="pre">'min'</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="s"><span class="pre">'max'</span></span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">,</span></span><span class="w"> </span><span class="pre">int</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">float</span><span class="p"><span class="pre">]</span></span><span class="p"><span class="pre">]</span></span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="n"><span class="pre">save</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">str</span><span class="w"> </span><span class="p"><span class="pre">|</span></span><span class="w"> </span><span class="pre">None</span></span><span class="w"> </span><span class="o"><span class="pre">=</span></span><span class="w"> </span><span class="default_value"><span class="pre">None</span></span></em>, <em class="sig-param"><span class="o"><span class="pre">**</span></span><span class="n"><span class="pre">kwargs</span></span><span class="p"><span class="pre">:</span></span><span class="w"> </span><span class="n"><span class="pre">Any</span></span></em><span class="sig-paren">)</span> <span class="sig-return"><span class="sig-return-icon">&#x2192;</span> <span class="sig-return-typehint"><span class="pre">ndarray</span></span></span><a class="reference internal" href="../_modules/sctoolbox/plotting/general.html#pairwise_scatter"><span class="viewcode-link"><span class="pre">[source]</span></span></a><a class="headerlink" href="#sctoolbox.plotting.general.pairwise_scatter" title="Link to this definition"></a></dt>
<dd><p>Plot a grid of scatterplot comparing column values pairwise.</p>
<p>If thresholds are given, lines are drawn for each threshold and points outside of the thresholds are colored red.</p>
<dl class="field-list simple">
<dt class="field-odd">Parameters<span class="colon">:</span></dt>
<dd class="field-odd"><ul class="simple">
<li><p><strong>table</strong> (<em>pd.DataFrame</em>) – Dataframe containing the data to plot.</p></li>
<li><p><strong>columns</strong> (<em>list</em><em>[</em><em>str</em><em>]</em>) – List of column names in table to plot.</p></li>
<li><p><strong>thresholds</strong> (<em>Optional</em><em>[</em><em>dict</em><em>[</em><em>str</em><em>, </em><em>dict</em><em>[</em><em>Literal</em><em>[</em><em>&quot;min&quot;</em><em>, </em><em>&quot;max&quot;</em><em>]</em><em>, </em><em>int</em><em> | </em><em>float</em><em>]</em><em>]</em><em>]</em><em>, </em><em>default None</em>) – Dictionary containing thresholds for each column. Keys are column names and values are dictionaries with keys “min” and “max”.</p></li>
<li><p><strong>save</strong> (<em>Optional</em><em>[</em><em>str</em><em>]</em><em>, </em><em>default None</em>) – If given, the figure will be saved to this path.</p></li>
<li><p><strong>**kwargs</strong> (<em>Any</em>) – Additional arguments to pass to matplotlib.axes.Axes.scatter.</p></li>
</ul>
</dd>
<dt class="field-even">Returns<span class="colon">:</span></dt>
<dd class="field-even"><p>Array of matplotlib.axes.Axes objects.</p>
</dd>
<dt class="field-odd">Return type<span class="colon">:</span></dt>
<dd class="field-odd"><p>np.ndarray</p>
</dd>
<dt class="field-even">Raises<span class="colon">:</span></dt>
<dd class="field-even"><p><strong>ValueError</strong> – <ol class="arabic simple">
<li><p>If columns contains less than two columns.
    2. If one of the given columns is not a table column</p></li>
</ol>
</p>
</dd>
</dl>
<p class="rubric">Examples</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;percent_mito&quot;</span><span class="p">,</span> <span class="s2">&quot;n_counts&quot;</span><span class="p">,</span> <span class="s2">&quot;S_score&quot;</span><span class="p">]</span>

<span class="n">thresholds</span> <span class="o">=</span> <span class="p">{</span><span class="s2">&quot;n_counts&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;min&quot;</span><span class="p">:</span> <span class="mi">2500</span><span class="p">,</span> <span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mi">8000</span><span class="p">},</span>
              <span class="s2">&quot;percent_mito&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mf">0.03</span><span class="p">},</span>
              <span class="s2">&quot;S_score&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;max&quot;</span><span class="p">:</span> <span class="mf">0.5</span><span class="p">}}</span>

<span class="n">pl</span><span class="o">.</span><span class="n">pairwise_scatter</span><span class="p">(</span><span class="n">adata</span><span class="o">.</span><span class="n">obs</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">thresholds</span><span class="o">=</span><span class="n">thresholds</span><span class="p">)</span>
</pre></div>
</div>
<figure class="align-default">
<img alt="../_images/plotting-46.png" class="plot-directive" src="../_images/plotting-46.png" />
</figure>
</dd></dl>

<hr class="docutils" />
</section>
</section>


           </div>
          </div>
          <footer><div class="rst-footer-buttons" role="navigation" aria-label="Footer">
        <a href="tools.html" class="btn btn-neutral float-left" title="Tools" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
        <a href="utils.html" class="btn btn-neutral float-right" title="Utils" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2024, Loosolab.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>